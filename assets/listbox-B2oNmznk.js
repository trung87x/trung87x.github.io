import{T as Le,k as ue,u as H,x as ge,a as ke,G as we,r as v,c as Me,Y as G,y as j,S as E,n as Te,o as F,s as O,as as Ce,$ as De,b as Ae,w as Fe,d as K,V as Oe,K as W,e as ve,f as _e,N as Ne,i as ne,p as Ve,g as Be,l as ze,q as Qe,m as Ue,t as ce,R as He,v as be,B as Ke,C as w,D as qe,ak as Ge,E as de,F as je,a1 as We,I as Je,J as Ye,P as Ze,Q as me,U as Xe}from"./index-CvCVbuS9.js";import{u as et}from"./use-by-comparator-Ch7KvTmY.js";import{l as tt,b as nt}from"./use-default-value-Cs7QsSkB.js";import{F as ot,b as it,y as st,R as at,T as lt,w as rt,A as ut}from"./floating-CjydGm1Z.js";import{p as ct,c as ee,a as h,f as Z,b as dt,L as pt,S as X,s as ft,u as vt}from"./element-movement-BT6A7GGi.js";import{e as bt}from"./use-resolve-button-type-J0J8N5g4.js";import{s as mt}from"./use-text-value-CB9rzUUM.js";import{g as ht,j as xt}from"./form-fields-DfbHTuSb.js";import{u as gt}from"./frozen-ohsQXSW6.js";import{Z as Ot,u as St,N as $t,V as It}from"./label-CY_Q6YdE.js";var yt=Object.defineProperty,Et=(e,i,t)=>i in e?yt(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,he=(e,i,t)=>(Et(e,typeof i!="symbol"?i+"":i,t),t),S=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(S||{}),B=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(B||{}),te=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(te||{}),Se=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.SelectOption=5]="SelectOption",e[e.RegisterOptions=6]="RegisterOptions",e[e.UnregisterOptions=7]="UnregisterOptions",e[e.SetButtonElement=8]="SetButtonElement",e[e.SetOptionsElement=9]="SetOptionsElement",e[e.SortOptions=10]="SortOptions",e[e.MarkButtonAsMoved=11]="MarkButtonAsMoved",e))(Se||{});function xe(e,i=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=we(i(e.options.slice()),s=>s.dataRef.current.domRef.current),o=t?n.indexOf(t):null;return o===-1&&(o=null),{options:n,activeOptionIndex:o}}let Rt={1(e){if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.buttonElement?ee.Tracked(dt(e.buttonElement)):e.buttonPositionState;return{...e,activeOptionIndex:null,pendingFocus:{focus:h.Nothing},listboxState:1,__demoMode:!1,buttonPositionState:i}},0(e,i){if(e.dataRef.current.disabled||e.listboxState===0)return e;let t=e.activeOptionIndex,{isSelected:n}=e.dataRef.current,o=e.options.findIndex(s=>n(s.dataRef.current.value));return o!==-1&&(t=o),{...e,frozenValue:!1,pendingFocus:i.focus,listboxState:0,activeOptionIndex:t,__demoMode:!1,buttonPositionState:ee.Idle}},2(e,i){var t,n,o,s,d;if(e.dataRef.current.disabled||e.listboxState===1)return e;let c={...e,searchQuery:"",activationTrigger:(t=i.trigger)!=null?t:1,__demoMode:!1};if(i.focus===h.Nothing)return{...c,activeOptionIndex:null};if(i.focus===h.Specific)return{...c,activeOptionIndex:e.options.findIndex(b=>b.id===i.id)};if(i.focus===h.Previous){let b=e.activeOptionIndex;if(b!==null){let g=e.options[b].dataRef.current.domRef,u=Z(i,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});if(u!==null){let a=e.options[u].dataRef.current.domRef;if(((n=g.current)==null?void 0:n.previousElementSibling)===a.current||((o=a.current)==null?void 0:o.previousElementSibling)===null)return{...c,activeOptionIndex:u}}}}else if(i.focus===h.Next){let b=e.activeOptionIndex;if(b!==null){let g=e.options[b].dataRef.current.domRef,u=Z(i,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});if(u!==null){let a=e.options[u].dataRef.current.domRef;if(((s=g.current)==null?void 0:s.nextElementSibling)===a.current||((d=a.current)==null?void 0:d.nextElementSibling)===null)return{...c,activeOptionIndex:u}}}}let m=xe(e),r=Z(i,{resolveItems:()=>m.options,resolveActiveIndex:()=>m.activeOptionIndex,resolveId:b=>b.id,resolveDisabled:b=>b.dataRef.current.disabled});return{...c,...m,activeOptionIndex:r}},3:(e,i)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let t=e.searchQuery!==""?0:1,n=e.searchQuery+i.value.toLowerCase(),o=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+t).concat(e.options.slice(0,e.activeOptionIndex+t)):e.options).find(d=>{var c;return!d.dataRef.current.disabled&&((c=d.dataRef.current.textValue)==null?void 0:c.startsWith(n))}),s=o?e.options.indexOf(o):-1;return s===-1||s===e.activeOptionIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeOptionIndex:s,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5(e){return e.dataRef.current.mode===0?{...e,frozenValue:!0}:{...e}},6:(e,i)=>{let t=e.options.concat(i.options),n=e.activeOptionIndex;if(e.pendingFocus.focus!==h.Nothing&&(n=Z(e.pendingFocus,{resolveItems:()=>t,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:o=>o.id,resolveDisabled:o=>o.dataRef.current.disabled})),e.activeOptionIndex===null){let{isSelected:o}=e.dataRef.current;if(o){let s=t.findIndex(d=>o?.(d.dataRef.current.value));s!==-1&&(n=s)}}return{...e,options:t,activeOptionIndex:n,pendingFocus:{focus:h.Nothing},pendingShouldSort:!0}},7:(e,i)=>{let t=e.options,n=[],o=new Set(i.options);for(let[s,d]of t.entries())if(o.has(d.id)&&(n.push(s),o.delete(d.id),o.size===0))break;if(n.length>0){t=t.slice();for(let s of n.reverse())t.splice(s,1)}return{...e,options:t,activationTrigger:1}},8:(e,i)=>e.buttonElement===i.element?e:{...e,buttonElement:i.element},9:(e,i)=>e.optionsElement===i.element?e:{...e,optionsElement:i.element},10:e=>e.pendingShouldSort?{...e,...xe(e),pendingShouldSort:!1}:e,11(e){return e.buttonPositionState.kind!=="Tracked"?e:{...e,buttonPositionState:ee.Moved}}};class pe extends Le{constructor(i){super(i),he(this,"actions",{onChange:t=>{let{onChange:n,compare:o,mode:s,value:d}=this.state.dataRef.current;return H(s,{0:()=>n?.(t),1:()=>{let c=d.slice(),m=c.findIndex(r=>o(r,t));return m===-1?c.push(t):c.splice(m,1),n?.(c)}})},registerOption:ue(()=>{let t=[],n=new Set;return[(o,s)=>{n.has(s)||(n.add(s),t.push({id:o,dataRef:s}))},()=>(n.clear(),this.send({type:6,options:t.splice(0)}))]}),unregisterOption:ue(()=>{let t=[];return[n=>t.push(n),()=>{this.send({type:7,options:t.splice(0)})}]}),goToOption:ue(()=>{let t=null;return[(n,o)=>{t={type:2,...n,trigger:o}},()=>t&&this.send(t)]}),closeListbox:()=>{this.send({type:1})},openListbox:t=>{this.send({type:0,focus:t})},selectActiveOption:()=>{var t;if(this.state.activeOptionIndex!==null){let{dataRef:n}=this.state.options[this.state.activeOptionIndex];this.actions.selectOption(n.current.value)}else this.state.dataRef.current.mode===0&&(this.actions.closeListbox(),(t=this.state.buttonElement)==null||t.focus({preventScroll:!0}))},selectOption:t=>{this.send({type:5,value:t})},search:t=>{this.send({type:3,value:t})},clearSearch:()=>{this.send({type:4})},setButtonElement:t=>{this.send({type:8,element:t})},setOptionsElement:t=>{this.send({type:9,element:t})}}),he(this,"selectors",{activeDescendantId(t){var n;let o=t.activeOptionIndex,s=t.options;return o===null||(n=s[o])==null?void 0:n.id},isActive(t,n){var o;let s=t.activeOptionIndex,d=t.options;return s!==null?((o=d[s])==null?void 0:o.id)===n:!1},hasFrozenValue(t){return t.frozenValue},shouldScrollIntoView(t,n){return t.__demoMode||t.listboxState!==0||t.activationTrigger===0?!1:this.isActive(t,n)},didButtonMove(t){return t.buttonPositionState.kind==="Moved"}}),this.on(6,()=>{requestAnimationFrame(()=>{this.send({type:10})})});{let t=this.state.id,n=ge.get(null);this.disposables.add(n.on(ke.Push,o=>{!n.selectors.isTop(o,t)&&this.state.listboxState===0&&this.actions.closeListbox()})),this.on(0,()=>n.actions.push(t)),this.on(1,()=>n.actions.pop(t))}this.disposables.group(t=>{this.on(1,n=>{n.buttonElement&&(t.dispose(),t.add(ct(n.buttonElement,n.buttonPositionState,()=>{this.send({type:11})})))})}),this.on(5,(t,n)=>{var o;this.actions.onChange(n.value),this.state.dataRef.current.mode===0&&(this.actions.closeListbox(),(o=this.state.buttonElement)==null||o.focus({preventScroll:!0}))})}static new({id:i,__demoMode:t=!1}){return new pe({id:i,dataRef:{current:{}},listboxState:t?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,buttonElement:null,optionsElement:null,pendingShouldSort:!1,pendingFocus:{focus:h.Nothing},frozenValue:!1,__demoMode:t,buttonPositionState:ee.Idle})}reduce(i,t){return H(t.type,Rt,i,t)}}const $e=v.createContext(null);function fe(e){let i=v.useContext($e);if(i===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Ie),t}return i}function Ie({id:e,__demoMode:i=!1}){let t=v.useMemo(()=>pe.new({id:e,__demoMode:i}),[]);return Me(()=>t.dispose()),t}let oe=v.createContext(null);oe.displayName="ListboxDataContext";function J(e){let i=v.useContext(oe);if(i===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,J),t}return i}let Pt=v.Fragment;function Lt(e,i){let t=v.useId(),n=We(),{value:o,defaultValue:s,form:d,name:c,onChange:m,by:r,invalid:b=!1,disabled:g=n||!1,horizontal:u=!1,multiple:a=!1,__demoMode:x=!1,...L}=e;const R=u?"horizontal":"vertical";let _=j(i),M=tt(s),[$=a?[]:void 0,P]=nt(o,m,M),I=Ie({id:t,__demoMode:x}),N=v.useRef({static:!1,hold:!1}),z=v.useRef(new Map),T=et(r),Q=v.useCallback(y=>H(p.mode,{[B.Multi]:()=>$.some(q=>T(q,y)),[B.Single]:()=>T($,y)}),[$]),p=K({value:$,disabled:g,invalid:b,mode:a?B.Multi:B.Single,orientation:R,onChange:P,compare:T,isSelected:Q,optionsPropsRef:N,listRef:z});de(()=>{I.state.dataRef.current=p},[p]);let k=E(I,y=>y.listboxState),C=ge.get(null),U=E(C,v.useCallback(y=>C.selectors.isTop(y,t),[C,t])),[D,f]=E(I,y=>[y.buttonElement,y.optionsElement]);Je(U,[D,f],(y,q)=>{I.send({type:Se.CloseListbox}),Ye(q,Xe.Loose)||(y.preventDefault(),D?.focus())});let A=K({open:k===S.Open,disabled:g,invalid:b,value:$}),[ie,se]=It({inherit:!0}),Y={ref:_},ae=v.useCallback(()=>{if(M!==void 0)return P?.(M)},[P,M]),le=W();return w.createElement(se,{value:ie,props:{htmlFor:D?.id},slot:{open:k===S.Open,disabled:g}},w.createElement(ut,null,w.createElement($e.Provider,{value:I},w.createElement(oe.Provider,{value:p},w.createElement(Ze,{value:H(k,{[S.Open]:ne.Open,[S.Closed]:ne.Closed})},c!=null&&$!=null&&w.createElement(xt,{disabled:g,data:{[c]:$},form:d,onReset:ae}),le({ourProps:Y,theirProps:L,slot:A,defaultTag:Pt,name:"Listbox"}))))))}let kt="button";function wt(e,i){let t=v.useId(),n=St(),o=J("Listbox.Button"),s=fe("Listbox.Button"),{id:d=n||`headlessui-listbox-button-${t}`,disabled:c=o.disabled||!1,autoFocus:m=!1,...r}=e,b=j(i,ot(),s.actions.setButtonElement),g=it(),[u,a,x]=E(s,f=>[f.listboxState,f.buttonElement,f.optionsElement]),L=u===S.Open;pt(L,{trigger:a,action:v.useCallback(f=>{if(a!=null&&a.contains(f.target))return X.Ignore;let A=f.target.closest('[role="option"]:not([data-disabled])');return Te(A)?X.Select(A):x!=null&&x.contains(f.target)?X.Ignore:X.Close},[a,x]),close:s.actions.closeListbox,select:s.actions.selectActiveOption});let R=F(f=>{switch(f.key){case O.Enter:ht(f.currentTarget);break;case O.Space:case O.ArrowDown:f.preventDefault(),s.actions.openListbox({focus:o.value?h.Nothing:h.First});break;case O.ArrowUp:f.preventDefault(),s.actions.openListbox({focus:o.value?h.Nothing:h.Last});break}}),_=F(f=>{f.key===O.Space&&f.preventDefault()}),M=ft(f=>{var A;s.state.listboxState===S.Open?(ce.flushSync(()=>s.actions.closeListbox()),(A=s.state.buttonElement)==null||A.focus({preventScroll:!0})):(f.preventDefault(),s.actions.openListbox({focus:h.Nothing}))}),$=F(f=>f.preventDefault()),P=$t([d]),I=Ce(),{isFocusVisible:N,focusProps:z}=De({autoFocus:m}),{isHovered:T,hoverProps:Q}=Ae({isDisabled:c}),{pressed:p,pressProps:k}=Fe({disabled:c}),C=K({open:u===S.Open,active:p||u===S.Open,disabled:c,invalid:o.invalid,value:o.value,hover:T,focus:N,autofocus:m}),U=E(s,f=>f.listboxState===S.Open),D=Oe(g(),{ref:b,id:d,type:bt(e,a),"aria-haspopup":"listbox","aria-controls":x?.id,"aria-expanded":U,"aria-labelledby":P,"aria-describedby":I,disabled:c||void 0,autoFocus:m,onKeyDown:R,onKeyUp:_,onKeyPress:$},M,z,Q,k);return W()({ourProps:D,theirProps:r,slot:C,defaultTag:kt,name:"Listbox.Button"})}let ye=v.createContext(!1),Mt="div",Tt=me.RenderStrategy|me.Static;function Ct(e,i){let t=v.useId(),{id:n=`headlessui-listbox-options-${t}`,anchor:o,portal:s=!1,modal:d=!0,transition:c=!1,...m}=e,r=st(o),[b,g]=v.useState(null);r&&(s=!0);let u=J("Listbox.Options"),a=fe("Listbox.Options"),[x,L,R,_]=E(a,l=>[l.listboxState,l.buttonElement,l.optionsElement,l.__demoMode]),M=ve(L),$=ve(R),P=_e(),[I,N]=Ne(c,b,P!==null?(P&ne.Open)===ne.Open:x===S.Open);Ve(I,L,a.actions.closeListbox);let z=_?!1:d&&x===S.Open;Be(z,$);let T=_?!1:d&&x===S.Open;ze(T,{allowed:v.useCallback(()=>[L,R],[L,R])});let Q=E(a,a.selectors.didButtonMove)?!1:I,p=E(a,a.selectors.hasFrozenValue)&&!e.static,k=gt(p,u.value),C=v.useCallback(l=>u.compare(k,l),[u.compare,k]),U=E(a,l=>{var V;if(r==null||!((V=r?.to)!=null&&V.includes("selection")))return null;let re=l.options.findIndex(Pe=>C(Pe.dataRef.current.value));return re===-1&&(re=0),re}),D=(()=>{if(r==null)return;if(U===null)return{...r,inner:void 0};let l=Array.from(u.listRef.current.values());return{...r,inner:{listRef:{current:l},index:U}}})(),[f,A]=at(D),ie=lt(),se=j(i,r?f:null,a.actions.setOptionsElement,g),Y=Qe();v.useEffect(()=>{let l=R;l&&x===S.Open&&(Ue(l)||l==null||l.focus({preventScroll:!0}))},[x,R]);let ae=F(l=>{var V;switch(Y.dispose(),l.key){case O.Space:if(a.state.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),a.actions.search(l.key);case O.Enter:l.preventDefault(),l.stopPropagation(),a.actions.selectActiveOption();break;case H(u.orientation,{vertical:O.ArrowDown,horizontal:O.ArrowRight}):return l.preventDefault(),l.stopPropagation(),a.actions.goToOption({focus:h.Next});case H(u.orientation,{vertical:O.ArrowUp,horizontal:O.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),a.actions.goToOption({focus:h.Previous});case O.Home:case O.PageUp:return l.preventDefault(),l.stopPropagation(),a.actions.goToOption({focus:h.First});case O.End:case O.PageDown:return l.preventDefault(),l.stopPropagation(),a.actions.goToOption({focus:h.Last});case O.Escape:l.preventDefault(),l.stopPropagation(),ce.flushSync(()=>a.actions.closeListbox()),(V=a.state.buttonElement)==null||V.focus({preventScroll:!0});return;case O.Tab:l.preventDefault(),l.stopPropagation(),ce.flushSync(()=>a.actions.closeListbox()),He(a.state.buttonElement,l.shiftKey?be.Previous:be.Next);break;default:l.key.length===1&&(a.actions.search(l.key),Y.setTimeout(()=>a.actions.clearSearch(),350));break}}),le=E(a,l=>{var V;return(V=l.buttonElement)==null?void 0:V.id}),y=K({open:x===S.Open}),q=Oe(r?ie():{},{id:n,ref:se,"aria-activedescendant":E(a,a.selectors.activeDescendantId),"aria-multiselectable":u.mode===B.Multi?!0:void 0,"aria-labelledby":le,"aria-orientation":u.orientation,onKeyDown:ae,role:"listbox",tabIndex:x===S.Open?0:void 0,style:{...m.style,...A,"--button-width":rt(I,L,!0).width},...Ke(N)}),Ee=W(),Re=v.useMemo(()=>u.mode===B.Multi?u:{...u,isSelected:C},[u,C]);return w.createElement(qe,{enabled:s?e.static||I:!1,ownerDocument:M},w.createElement(oe.Provider,{value:Re},Ee({ourProps:q,theirProps:m,slot:y,defaultTag:Mt,features:Tt,visible:Q,name:"Listbox.Options"})))}let Dt="div";function At(e,i){let t=v.useId(),{id:n=`headlessui-listbox-option-${t}`,disabled:o=!1,value:s,...d}=e,c=v.useContext(ye)===!0,m=J("Listbox.Option"),r=fe("Listbox.Option"),b=E(r,p=>r.selectors.isActive(p,n)),g=m.isSelected(s),u=v.useRef(null),a=mt(u),x=Ge({disabled:o,value:s,domRef:u,get textValue(){return a()}}),L=j(i,u,p=>{p?m.listRef.current.set(n,p):m.listRef.current.delete(n)}),R=E(r,p=>r.selectors.shouldScrollIntoView(p,n));de(()=>{if(R)return je().requestAnimationFrame(()=>{var p,k;(k=(p=u.current)==null?void 0:p.scrollIntoView)==null||k.call(p,{block:"nearest"})})},[R,u]),de(()=>{if(!c)return r.actions.registerOption(n,x),()=>r.actions.unregisterOption(n)},[x,n,c]);let _=F(p=>{if(o)return p.preventDefault();r.actions.selectOption(s)}),M=F(()=>{if(o)return r.actions.goToOption({focus:h.Nothing});r.actions.goToOption({focus:h.Specific,id:n})}),$=vt(),P=F(p=>$.update(p)),I=F(p=>{$.wasMoved(p)&&(o||b&&r.state.activationTrigger===te.Pointer||r.actions.goToOption({focus:h.Specific,id:n},te.Pointer))}),N=F(p=>{$.wasMoved(p)&&(o||b&&r.state.activationTrigger===te.Pointer&&r.actions.goToOption({focus:h.Nothing}))}),z=K({active:b,focus:b,selected:g,disabled:o,selectedOption:g&&c}),T=c?{}:{id:n,ref:L,role:"option",tabIndex:o===!0?void 0:-1,"aria-disabled":o===!0?!0:void 0,"aria-selected":g,disabled:void 0,onClick:_,onFocus:M,onPointerEnter:P,onMouseEnter:P,onPointerMove:I,onMouseMove:I,onPointerLeave:N,onMouseLeave:N},Q=W();return!g&&c?null:Q({ourProps:T,theirProps:d,slot:z,defaultTag:Dt,name:"Listbox.Option"})}let Ft=v.Fragment;function _t(e,i){let{options:t,placeholder:n,...o}=e,s={ref:j(i)},d=J("ListboxSelectedOption"),c=K({}),m=d.value===void 0||d.value===null||d.mode===B.Multi&&Array.isArray(d.value)&&d.value.length===0,r=W();return w.createElement(ye.Provider,{value:!0},r({ourProps:s,theirProps:{...o,children:w.createElement(w.Fragment,null,n&&m?n:t)},slot:c,defaultTag:Ft,name:"ListboxSelectedOption"}))}let Nt=G(Lt),Vt=G(wt),Bt=Ot,zt=G(Ct),Qt=G(At),Ut=G(_t),en=Object.assign(Nt,{Button:Vt,Label:Bt,Options:zt,Option:Qt,SelectedOption:Ut});export{zt as B,Qt as I,en as M,Vt as a,Ut as k};
