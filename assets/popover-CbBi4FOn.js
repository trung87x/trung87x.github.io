import{T as Re,n as fe,a0 as Ae,ab as me,x as Ge,u as Z,r as u,c as Ne,Y as z,y as q,o as g,d as ae,K as re,C as S,ac as Oe,S as U,$ as je,b as Le,w as He,V as ve,ad as ke,ae as be,af as $e,e as ge,E as Ke,f as Ee,N as Fe,p as Ve,g as We,ag as oe,ah as H,v as A,B as we,a7 as Ye,aa as xe,D as Qe,ai as he,a8 as Ze,aj as qe,ak as Ce,al as Ue,am as Je,an as ze,ao as Xe,I as et,i as J,P as tt,ap as G,aq as Pe,Q as ue,s as L,_ as nt,J as ot,U as at}from"./index-CvCVbuS9.js";import{F as rt,y as st,R as lt,T as ut,w as ct,A as it}from"./floating-CjydGm1Z.js";import{e as pt}from"./use-resolve-button-type-J0J8N5g4.js";import{s as _e}from"./bugs-qQ_SbDk4.js";var dt=Object.defineProperty,ft=(e,a,t)=>a in e?dt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,Be=(e,a,t)=>(ft(e,typeof a!="symbol"?a+"":a,t),t),P=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(P||{}),vt=(e=>(e[e.OpenPopover=0]="OpenPopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(vt||{});let bt={0:e=>e.popoverState===0?e:{...e,popoverState:0,__demoMode:!1},1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,a){return e.button===a.button?e:{...e,button:a.button}},3(e,a){return e.buttonId===a.buttonId?e:{...e,buttonId:a.buttonId}},4(e,a){return e.panel===a.panel?e:{...e,panel:a.panel}},5(e,a){return e.panelId===a.panelId?e:{...e,panelId:a.panelId}}};class Se extends Re{constructor(a){super(a),Be(this,"actions",{close:()=>this.send({type:1}),refocusableClose:t=>{this.actions.close();let f=t?fe(t)?t:"current"in t&&fe(t.current)?t.current:this.state.button:this.state.button;f?.focus()},open:()=>this.send({type:0}),setButtonId:t=>this.send({type:3,buttonId:t}),setButton:t=>this.send({type:2,button:t}),setPanelId:t=>this.send({type:5,panelId:t}),setPanel:t=>this.send({type:4,panel:t})}),Be(this,"selectors",{isPortalled:t=>{var f;if(!t.button||!t.panel)return!1;let b=(f=Ae(t.button))!=null?f:document;for(let y of b.querySelectorAll("body > *"))if(Number(y?.contains(t.button))^Number(y?.contains(t.panel)))return!0;let $=me(b),s=$.indexOf(t.button),n=(s+$.length-1)%$.length,B=(s+1)%$.length,C=$[n],r=$[B];return!t.panel.contains(C)&&!t.panel.contains(r)}});{let t=this.state.id,f=Ge.get(null);this.on(0,()=>f.actions.push(t)),this.on(1,()=>f.actions.pop(t))}}static new({id:a,__demoMode:t=!1}){return new Se({id:a,__demoMode:t,popoverState:t?0:1,buttons:{current:[]},button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:{current:null},afterPanelSentinel:{current:null},afterButtonSentinel:{current:null}})}reduce(a,t){return Z(t.type,bt,a,t)}}const De=u.createContext(null);function ce(e){let a=u.useContext(De);if(a===null){let t=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ce),t}return a}function $t({id:e,__demoMode:a=!1}){let t=u.useMemo(()=>Se.new({id:e,__demoMode:a}),[]);return Ne(()=>t.dispose()),t}let ye=u.createContext(null);ye.displayName="PopoverGroupContext";function Te(){return u.useContext(ye)}let ie=u.createContext(null);ie.displayName="PopoverPanelContext";function Pt(){return u.useContext(ie)}let mt="div";function ht(e,a){var t;let f=u.useId(),{__demoMode:b=!1,...$}=e,s=$t({id:f,__demoMode:b}),n=u.useRef(null),B=q(a,Ze(l=>{n.current=l})),[C,r,y,I,F]=U(s,u.useCallback(l=>[l.popoverState,l.button,l.panel,l.buttonId,l.panelId],[])),w=qe((t=n.current)!=null?t:r),d=Ce(I),v=Ce(F),m=u.useMemo(()=>({buttonId:d,panelId:v,close:s.actions.close}),[d,v,s]),h=Te(),c=h?.registerPopover,O=g(()=>{var l,k;let x=oe((l=n.current)!=null?l:r);return(k=h?.isFocusWithinPopoverGroup())!=null?k:x&&(r?.contains(x)||y?.contains(x))});u.useEffect(()=>c?.(m),[c,m]);let[X,ee]=Ue(),N=Je(r),M=ze({mainTreeNode:N,portals:X,defaultContainers:[{get current(){return s.state.button}},{get current(){return s.state.panel}}]});Xe(w,"focus",l=>{var k,x,D,Y,T,Q;l.target!==window&&nt(l.target)&&s.state.popoverState===P.Open&&(O()||s.state.button&&s.state.panel&&(M.contains(l.target)||(x=(k=s.state.beforePanelSentinel.current)==null?void 0:k.contains)!=null&&x.call(k,l.target)||(Y=(D=s.state.afterPanelSentinel.current)==null?void 0:D.contains)!=null&&Y.call(D,l.target)||(Q=(T=s.state.afterButtonSentinel.current)==null?void 0:T.contains)!=null&&Q.call(T,l.target)||s.actions.close()))},!0);let K=C===P.Open;et(K,M.resolveContainers,(l,k)=>{s.actions.close(),ot(k,at.Loose)||(l.preventDefault(),r?.focus())});let te=ae({open:C===P.Open,close:s.actions.refocusableClose}),ne=U(s,u.useCallback(l=>Z(l.popoverState,{[P.Open]:J.Open,[P.Closed]:J.Closed}),[])),V={ref:B},W=re();return S.createElement(Oe,{node:N},S.createElement(it,null,S.createElement(ie.Provider,{value:null},S.createElement(De.Provider,{value:s},S.createElement(xe,{value:s.actions.refocusableClose},S.createElement(tt,{value:ne},S.createElement(ee,null,W({ourProps:V,theirProps:$,slot:te,defaultTag:mt,name:"Popover"}))))))))}let St="button";function yt(e,a){let t=u.useId(),{id:f=`headlessui-popover-button-${t}`,disabled:b=!1,autoFocus:$=!1,...s}=e,n=ce("Popover.Button"),[B,C,r,y,I,F,w]=U(n,u.useCallback(o=>[o.popoverState,n.selectors.isPortalled(o),o.button,o.buttonId,o.panel,o.panelId,o.afterButtonSentinel],[])),d=u.useRef(null),v=`headlessui-focus-sentinel-${u.useId()}`,m=Te(),h=m?.closeOthers,c=Pt()!==null;u.useEffect(()=>{if(!c)return n.actions.setButtonId(f),()=>n.actions.setButtonId(null)},[c,f,n]);let[O]=u.useState(()=>Symbol()),X=q(d,a,rt(),g(o=>{if(!c){if(o)n.state.buttons.current.push(O);else{let i=n.state.buttons.current.indexOf(O);i!==-1&&n.state.buttons.current.splice(i,1)}n.state.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),o&&n.actions.setButton(o)}})),ee=q(d,a),N=g(o=>{var i,E,_;if(c){if(n.state.popoverState===P.Closed)return;switch(o.key){case L.Space:case L.Enter:o.preventDefault(),(E=(i=o.target).click)==null||E.call(i),n.actions.close(),(_=n.state.button)==null||_.focus();break}}else switch(o.key){case L.Space:case L.Enter:o.preventDefault(),o.stopPropagation(),n.state.popoverState===P.Closed?(h?.(n.state.buttonId),n.actions.open()):n.actions.close();break;case L.Escape:if(n.state.popoverState!==P.Open)return h?.(n.state.buttonId);if(!d.current)return;let R=oe(d.current);if(R&&!d.current.contains(R))return;o.preventDefault(),o.stopPropagation(),n.actions.close();break}}),M=g(o=>{c||o.key===L.Space&&o.preventDefault()}),K=g(o=>{var i,E;_e(o.currentTarget)||b||(c?(n.actions.close(),(i=n.state.button)==null||i.focus()):(o.preventDefault(),o.stopPropagation(),n.state.popoverState===P.Closed?(h?.(n.state.buttonId),n.actions.open()):n.actions.close(),(E=n.state.button)==null||E.focus()))}),te=g(o=>{o.preventDefault(),o.stopPropagation()}),{isFocusVisible:ne,focusProps:V}=je({autoFocus:$}),{isHovered:W,hoverProps:l}=Le({isDisabled:b}),{pressed:k,pressProps:x}=He({disabled:b}),D=B===P.Open,Y=ae({open:D,active:k||D,disabled:b,hover:W,focus:ne,autofocus:$}),T=pt(e,r),Q=c?ve({ref:ee,type:T,onKeyDown:N,onClick:K,disabled:b||void 0,autoFocus:$},V,l,x):ve({ref:X,id:y,type:T,"aria-expanded":B===P.Open,"aria-controls":I?F:void 0,disabled:b||void 0,autoFocus:$,onKeyDown:N,onKeyUp:M,onClick:K,onMouseDown:te},V,l,x),se=ke(),pe=g(()=>{if(!fe(n.state.panel))return;let o=n.state.panel;function i(){Z(se.current,{[G.Forwards]:()=>H(o,A.First),[G.Backwards]:()=>H(o,A.Last)})===Pe.Error&&H(me(he(n.state.button)).filter(E=>E.dataset.headlessuiFocusGuard!=="true"),Z(se.current,{[G.Forwards]:A.Next,[G.Backwards]:A.Previous}),{relativeTo:n.state.button})}i()}),p=re();return S.createElement(S.Fragment,null,p({ourProps:Q,theirProps:s,slot:Y,defaultTag:St,name:"Popover.Button"}),D&&!c&&C&&S.createElement(be,{id:v,ref:w,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:pe}))}let It="div",gt=ue.RenderStrategy|ue.Static;function Me(e,a){let t=u.useId(),{id:f=`headlessui-popover-backdrop-${t}`,transition:b=!1,...$}=e,s=ce("Popover.Backdrop"),n=U(s,u.useCallback(m=>m.popoverState,[])),[B,C]=u.useState(null),r=q(a,C),y=Ee(),[I,F]=Fe(b,B,y!==null?(y&J.Open)===J.Open:n===P.Open),w=g(m=>{if(_e(m.currentTarget))return m.preventDefault();s.actions.close()}),d=ae({open:n===P.Open}),v={ref:r,id:f,"aria-hidden":!0,onClick:w,...we(F)};return re()({ourProps:v,theirProps:$,slot:d,defaultTag:It,features:gt,visible:I,name:"Popover.Backdrop"})}let Ct="div",Bt=ue.RenderStrategy|ue.Static;function Ot(e,a){let t=u.useId(),{id:f=`headlessui-popover-panel-${t}`,focus:b=!1,anchor:$,portal:s=!1,modal:n=!1,transition:B=!1,...C}=e,r=ce("Popover.Panel"),y=U(r,r.selectors.isPortalled),[I,F,w,d,v]=U(r,u.useCallback(p=>[p.popoverState,p.button,p.__demoMode,p.beforePanelSentinel,p.afterPanelSentinel],[])),m=`headlessui-focus-sentinel-before-${t}`,h=`headlessui-focus-sentinel-after-${t}`,c=u.useRef(null),O=st($),[X,ee]=lt(O),N=ut();O&&(s=!0);let[M,K]=u.useState(null),te=q(c,a,O?X:null,r.actions.setPanel,K),ne=ge(F),V=ge(c.current);Ke(()=>(r.actions.setPanelId(f),()=>r.actions.setPanelId(null)),[f,r]);let W=Ee(),[l,k]=Fe(B,M,W!==null?(W&J.Open)===J.Open:I===P.Open);Ve(l,F,r.actions.close),We(w?!1:n&&l,V);let x=g(p=>{var o;switch(p.key){case L.Escape:if(r.state.popoverState!==P.Open||!c.current)return;let i=oe(c.current);if(i&&!c.current.contains(i))return;p.preventDefault(),p.stopPropagation(),r.actions.close(),(o=r.state.button)==null||o.focus();break}});u.useEffect(()=>{var p;e.static||I===P.Closed&&((p=e.unmount)==null||p)&&r.actions.setPanel(null)},[I,e.unmount,e.static,r]),u.useEffect(()=>{if(w||!b||I!==P.Open||!c.current)return;let p=oe(c.current);c.current.contains(p)||H(c.current,A.First)},[w,b,c.current,I]);let D=ae({open:I===P.Open,close:r.actions.refocusableClose}),Y=ve(O?N():{},{ref:te,id:f,onKeyDown:x,onBlur:b&&I===P.Open?p=>{var o,i,E,_,R;let j=p.relatedTarget;j&&c.current&&((o=c.current)!=null&&o.contains(j)||(r.actions.close(),((E=(i=d.current)==null?void 0:i.contains)!=null&&E.call(i,j)||(R=(_=v.current)==null?void 0:_.contains)!=null&&R.call(_,j))&&j.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...C.style,...ee,"--button-width":ct(l,F,!0).width},...we(k)}),T=ke(),Q=g(()=>{let p=c.current;if(!p)return;function o(){Z(T.current,{[G.Forwards]:()=>{var i;H(p,A.First)===Pe.Error&&((i=r.state.afterPanelSentinel.current)==null||i.focus())},[G.Backwards]:()=>{var i;(i=r.state.button)==null||i.focus({preventScroll:!0})}})}o()}),se=g(()=>{let p=c.current;if(!p)return;function o(){Z(T.current,{[G.Forwards]:()=>{var i;if(!r.state.button)return;let E=(i=he(r.state.button))!=null?i:document.body,_=me(E),R=_.indexOf(r.state.button),j=_.slice(0,R+1),le=[..._.slice(R+1),...j];for(let de of le.slice())if(de.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(de)){let Ie=le.indexOf(de);Ie!==-1&&le.splice(Ie,1)}H(le,A.First,{sorted:!1})},[G.Backwards]:()=>{var i;H(p,A.Previous)===Pe.Error&&((i=r.state.button)==null||i.focus())}})}o()}),pe=re();return S.createElement(Ye,null,S.createElement(ie.Provider,{value:f},S.createElement(xe,{value:r.actions.refocusableClose},S.createElement(Qe,{enabled:s?e.static||l:!1,ownerDocument:ne},l&&y&&S.createElement(be,{id:m,ref:d,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Q}),pe({ourProps:Y,theirProps:C,slot:D,defaultTag:Ct,features:Bt,visible:l,name:"Popover.Panel"}),l&&y&&S.createElement(be,{id:h,ref:v,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:se})))))}let kt="div";function Et(e,a){let t=u.useRef(null),f=q(t,a),[b,$]=u.useState([]),s=g(d=>{$(v=>{let m=v.indexOf(d);if(m!==-1){let h=v.slice();return h.splice(m,1),h}return v})}),n=g(d=>($(v=>[...v,d]),()=>s(d))),B=g(()=>{var d;let v=he(t.current);if(!v)return!1;let m=oe(t.current);return(d=t.current)!=null&&d.contains(m)?!0:b.some(h=>{var c,O;return((c=v.getElementById(h.buttonId.current))==null?void 0:c.contains(m))||((O=v.getElementById(h.panelId.current))==null?void 0:O.contains(m))})}),C=g(d=>{for(let v of b)v.buttonId.current!==d&&v.close()}),r=u.useMemo(()=>({registerPopover:n,unregisterPopover:s,isFocusWithinPopoverGroup:B,closeOthers:C}),[n,s,B,C]),y=ae({}),I=e,F={ref:f},w=re();return S.createElement(Oe,null,S.createElement(ye.Provider,{value:r},w({ourProps:F,theirProps:I,slot:y,defaultTag:kt,name:"Popover.Group"})))}let Ft=z(ht),wt=z(yt),xt=z(Me),_t=z(Me),Dt=z(Ot),Tt=z(Et),Nt=Object.assign(Ft,{Button:wt,Backdrop:_t,Overlay:xt,Panel:Dt,Group:Tt});export{wt as D,Dt as L,Tt as h,Nt as v,_t as x};
