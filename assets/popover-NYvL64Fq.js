import{$ as Re,a as Ae}from"./useFocusRing-DcMgcFf7.js";import{r as u,G as h}from"./index-BUE_4nSx.js";import{w as Ge}from"./use-active-press-CdjcnPjf.js";import{F as Ne,y as Le,R as je,T as He,w as Ke,A as Ve}from"./floating-DDf1F5o_.js";import{u as Z,Y as J,o as g,K as re,V as fe,n as We,b as ge,A as ue}from"./render-CNyBWpu3.js";import{E as Ye}from"./use-event-listener-DpzbZMQu.js";import{T as Qe,x as Ze,c as qe,S as q,u as Ce,p as Ue,f as ze,t as Je,d as Xe,e as et,k as tt}from"./portal-DcpW2Nz_.js";import{e as nt}from"./use-resolve-button-type-BuRlBvvn.js";import{j as xe,u as Oe,x as ot,S as rt,a as A}from"./use-tab-direction-D2DDqWO7.js";import{n as ae}from"./use-slot-BZcd_w4P.js";import{y as U,T as at}from"./use-sync-refs-Dh0umLOC.js";import{u as Ee,N as Fe,x as ke,s as lt,i as z,c as st}from"./open-closed-BGpwrHHP.js";import{C as we}from"./close-provider-CYB1hxin.js";import{f as ve,s as be}from"./hidden-c0o-GYKL.js";import{s as Te}from"./bugs-BLuxiOOY.js";import{n as me,i as ut}from"./dom-BlW_0b_t.js";import{x as Pe,v as H,T as G,A as $e,H as it,I as ct}from"./focus-management-C0S51YJM.js";import{l as pt,e as oe,r as Se}from"./owner-C7ikqkQc.js";import{o as j}from"./keyboard-C1Wiwm26.js";var dt=Object.defineProperty,ft=(e,r,t)=>r in e?dt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Be=(e,r,t)=>(ft(e,typeof r!="symbol"?r+"":r,t),t),$=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))($||{}),vt=(e=>(e[e.OpenPopover=0]="OpenPopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(vt||{});let bt={0:e=>e.popoverState===0?e:{...e,popoverState:0,__demoMode:!1},1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,r){return e.button===r.button?e:{...e,button:r.button}},3(e,r){return e.buttonId===r.buttonId?e:{...e,buttonId:r.buttonId}},4(e,r){return e.panel===r.panel?e:{...e,panel:r.panel}},5(e,r){return e.panelId===r.panelId?e:{...e,panelId:r.panelId}}};class he extends Qe{constructor(r){super(r),Be(this,"actions",{close:()=>this.send({type:1}),refocusableClose:t=>{this.actions.close();let f=t?me(t)?t:"current"in t&&me(t.current)?t.current:this.state.button:this.state.button;f?.focus()},open:()=>this.send({type:0}),setButtonId:t=>this.send({type:3,buttonId:t}),setButton:t=>this.send({type:2,button:t}),setPanelId:t=>this.send({type:5,panelId:t}),setPanel:t=>this.send({type:4,panel:t})}),Be(this,"selectors",{isPortalled:t=>{var f;if(!t.button||!t.panel)return!1;let b=(f=pt(t.button))!=null?f:document;for(let y of b.querySelectorAll("body > *"))if(Number(y?.contains(t.button))^Number(y?.contains(t.panel)))return!0;let m=Pe(b),l=m.indexOf(t.button),n=(l+m.length-1)%m.length,B=(l+1)%m.length,C=m[n],a=m[B];return!t.panel.contains(C)&&!t.panel.contains(a)}});{let t=this.state.id,f=Ze.get(null);this.on(0,()=>f.actions.push(t)),this.on(1,()=>f.actions.pop(t))}}static new({id:r,__demoMode:t=!1}){return new he({id:r,__demoMode:t,popoverState:t?0:1,buttons:{current:[]},button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:{current:null},afterPanelSentinel:{current:null},afterButtonSentinel:{current:null}})}reduce(r,t){return Z(t.type,bt,r,t)}}const _e=u.createContext(null);function ie(e){let r=u.useContext(_e);if(r===null){let t=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ie),t}return r}function mt({id:e,__demoMode:r=!1}){let t=u.useMemo(()=>he.new({id:e,__demoMode:r}),[]);return qe(()=>t.dispose()),t}let ye=u.createContext(null);ye.displayName="PopoverGroupContext";function De(){return u.useContext(ye)}let ce=u.createContext(null);ce.displayName="PopoverPanelContext";function $t(){return u.useContext(ce)}let Pt="div";function St(e,r){var t;let f=u.useId(),{__demoMode:b=!1,...m}=e,l=mt({id:f,__demoMode:b}),n=u.useRef(null),B=U(r,at(s=>{n.current=s})),[C,a,y,I,F]=q(l,u.useCallback(s=>[s.popoverState,s.button,s.panel,s.buttonId,s.panelId],[])),k=Xe((t=n.current)!=null?t:a),d=ge(I),v=ge(F),P=u.useMemo(()=>({buttonId:d,panelId:v,close:l.actions.close}),[d,v,l]),S=De(),i=S?.registerPopover,x=g(()=>{var s,O;let w=oe((s=n.current)!=null?s:a);return(O=S?.isFocusWithinPopoverGroup())!=null?O:w&&(a?.contains(w)||y?.contains(w))});u.useEffect(()=>i?.(P),[i,P]);let[X,ee]=et(),N=ot(a),M=rt({mainTreeNode:N,portals:X,defaultContainers:[{get current(){return l.state.button}},{get current(){return l.state.panel}}]});Ye(k,"focus",s=>{var O,w,_,Y,D,Q;s.target!==window&&ut(s.target)&&l.state.popoverState===$.Open&&(x()||l.state.button&&l.state.panel&&(M.contains(s.target)||(w=(O=l.state.beforePanelSentinel.current)==null?void 0:O.contains)!=null&&w.call(O,s.target)||(Y=(_=l.state.afterPanelSentinel.current)==null?void 0:_.contains)!=null&&Y.call(_,s.target)||(Q=(D=l.state.afterButtonSentinel.current)==null?void 0:D.contains)!=null&&Q.call(D,s.target)||l.actions.close()))},!0);let K=C===$.Open;tt(K,M.resolveContainers,(s,O)=>{l.actions.close(),it(O,ct.Loose)||(s.preventDefault(),a?.focus())});let te=ae({open:C===$.Open,close:l.actions.refocusableClose}),ne=q(l,u.useCallback(s=>Z(s.popoverState,{[$.Open]:z.Open,[$.Closed]:z.Closed}),[])),V={ref:B},W=re();return h.createElement(xe,{node:N},h.createElement(Ve,null,h.createElement(ce.Provider,{value:null},h.createElement(_e.Provider,{value:l},h.createElement(we,{value:l.actions.refocusableClose},h.createElement(st,{value:ne},h.createElement(ee,null,W({ourProps:V,theirProps:m,slot:te,defaultTag:Pt,name:"Popover"}))))))))}let ht="button";function yt(e,r){let t=u.useId(),{id:f=`headlessui-popover-button-${t}`,disabled:b=!1,autoFocus:m=!1,...l}=e,n=ie("Popover.Button"),[B,C,a,y,I,F,k]=q(n,u.useCallback(o=>[o.popoverState,n.selectors.isPortalled(o),o.button,o.buttonId,o.panel,o.panelId,o.afterButtonSentinel],[])),d=u.useRef(null),v=`headlessui-focus-sentinel-${u.useId()}`,P=De(),S=P?.closeOthers,i=$t()!==null;u.useEffect(()=>{if(!i)return n.actions.setButtonId(f),()=>n.actions.setButtonId(null)},[i,f,n]);let[x]=u.useState(()=>Symbol()),X=U(d,r,Ne(),g(o=>{if(!i){if(o)n.state.buttons.current.push(x);else{let c=n.state.buttons.current.indexOf(x);c!==-1&&n.state.buttons.current.splice(c,1)}n.state.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),o&&n.actions.setButton(o)}})),ee=U(d,r),N=g(o=>{var c,E,T;if(i){if(n.state.popoverState===$.Closed)return;switch(o.key){case j.Space:case j.Enter:o.preventDefault(),(E=(c=o.target).click)==null||E.call(c),n.actions.close(),(T=n.state.button)==null||T.focus();break}}else switch(o.key){case j.Space:case j.Enter:o.preventDefault(),o.stopPropagation(),n.state.popoverState===$.Closed?(S?.(n.state.buttonId),n.actions.open()):n.actions.close();break;case j.Escape:if(n.state.popoverState!==$.Open)return S?.(n.state.buttonId);if(!d.current)return;let R=oe(d.current);if(R&&!d.current.contains(R))return;o.preventDefault(),o.stopPropagation(),n.actions.close();break}}),M=g(o=>{i||o.key===j.Space&&o.preventDefault()}),K=g(o=>{var c,E;Te(o.currentTarget)||b||(i?(n.actions.close(),(c=n.state.button)==null||c.focus()):(o.preventDefault(),o.stopPropagation(),n.state.popoverState===$.Closed?(S?.(n.state.buttonId),n.actions.open()):n.actions.close(),(E=n.state.button)==null||E.focus()))}),te=g(o=>{o.preventDefault(),o.stopPropagation()}),{isFocusVisible:ne,focusProps:V}=Re({autoFocus:m}),{isHovered:W,hoverProps:s}=Ae({isDisabled:b}),{pressed:O,pressProps:w}=Ge({disabled:b}),_=B===$.Open,Y=ae({open:_,active:O||_,disabled:b,hover:W,focus:ne,autofocus:m}),D=nt(e,a),Q=i?fe({ref:ee,type:D,onKeyDown:N,onClick:K,disabled:b||void 0,autoFocus:m},V,s,w):fe({ref:X,id:y,type:D,"aria-expanded":B===$.Open,"aria-controls":I?F:void 0,disabled:b||void 0,autoFocus:m,onKeyDown:N,onKeyUp:M,onClick:K,onMouseDown:te},V,s,w),le=Oe(),pe=g(()=>{if(!me(n.state.panel))return;let o=n.state.panel;function c(){Z(le.current,{[A.Forwards]:()=>H(o,G.First),[A.Backwards]:()=>H(o,G.Last)})===$e.Error&&H(Pe(Se(n.state.button)).filter(E=>E.dataset.headlessuiFocusGuard!=="true"),Z(le.current,{[A.Forwards]:G.Next,[A.Backwards]:G.Previous}),{relativeTo:n.state.button})}c()}),p=re();return h.createElement(h.Fragment,null,p({ourProps:Q,theirProps:l,slot:Y,defaultTag:ht,name:"Popover.Button"}),_&&!i&&C&&h.createElement(ve,{id:v,ref:k,features:be.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:pe}))}let It="div",gt=ue.RenderStrategy|ue.Static;function Me(e,r){let t=u.useId(),{id:f=`headlessui-popover-backdrop-${t}`,transition:b=!1,...m}=e,l=ie("Popover.Backdrop"),n=q(l,u.useCallback(P=>P.popoverState,[])),[B,C]=u.useState(null),a=U(r,C),y=Ee(),[I,F]=Fe(b,B,y!==null?(y&z.Open)===z.Open:n===$.Open),k=g(P=>{if(Te(P.currentTarget))return P.preventDefault();l.actions.close()}),d=ae({open:n===$.Open}),v={ref:a,id:f,"aria-hidden":!0,onClick:k,...ke(F)};return re()({ourProps:v,theirProps:m,slot:d,defaultTag:It,features:gt,visible:I,name:"Popover.Backdrop"})}let Ct="div",Bt=ue.RenderStrategy|ue.Static;function xt(e,r){let t=u.useId(),{id:f=`headlessui-popover-panel-${t}`,focus:b=!1,anchor:m,portal:l=!1,modal:n=!1,transition:B=!1,...C}=e,a=ie("Popover.Panel"),y=q(a,a.selectors.isPortalled),[I,F,k,d,v]=q(a,u.useCallback(p=>[p.popoverState,p.button,p.__demoMode,p.beforePanelSentinel,p.afterPanelSentinel],[])),P=`headlessui-focus-sentinel-before-${t}`,S=`headlessui-focus-sentinel-after-${t}`,i=u.useRef(null),x=Le(m),[X,ee]=je(x),N=He();x&&(l=!0);let[M,K]=u.useState(null),te=U(i,r,x?X:null,a.actions.setPanel,K),ne=Ce(F),V=Ce(i.current);We(()=>(a.actions.setPanelId(f),()=>a.actions.setPanelId(null)),[f,a]);let W=Ee(),[s,O]=Fe(B,M,W!==null?(W&z.Open)===z.Open:I===$.Open);Ue(s,F,a.actions.close),ze(k?!1:n&&s,V);let w=g(p=>{var o;switch(p.key){case j.Escape:if(a.state.popoverState!==$.Open||!i.current)return;let c=oe(i.current);if(c&&!i.current.contains(c))return;p.preventDefault(),p.stopPropagation(),a.actions.close(),(o=a.state.button)==null||o.focus();break}});u.useEffect(()=>{var p;e.static||I===$.Closed&&((p=e.unmount)==null||p)&&a.actions.setPanel(null)},[I,e.unmount,e.static,a]),u.useEffect(()=>{if(k||!b||I!==$.Open||!i.current)return;let p=oe(i.current);i.current.contains(p)||H(i.current,G.First)},[k,b,i.current,I]);let _=ae({open:I===$.Open,close:a.actions.refocusableClose}),Y=fe(x?N():{},{ref:te,id:f,onKeyDown:w,onBlur:b&&I===$.Open?p=>{var o,c,E,T,R;let L=p.relatedTarget;L&&i.current&&((o=i.current)!=null&&o.contains(L)||(a.actions.close(),((E=(c=d.current)==null?void 0:c.contains)!=null&&E.call(c,L)||(R=(T=v.current)==null?void 0:T.contains)!=null&&R.call(T,L))&&L.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...C.style,...ee,"--button-width":Ke(s,F,!0).width},...ke(O)}),D=Oe(),Q=g(()=>{let p=i.current;if(!p)return;function o(){Z(D.current,{[A.Forwards]:()=>{var c;H(p,G.First)===$e.Error&&((c=a.state.afterPanelSentinel.current)==null||c.focus())},[A.Backwards]:()=>{var c;(c=a.state.button)==null||c.focus({preventScroll:!0})}})}o()}),le=g(()=>{let p=i.current;if(!p)return;function o(){Z(D.current,{[A.Forwards]:()=>{var c;if(!a.state.button)return;let E=(c=Se(a.state.button))!=null?c:document.body,T=Pe(E),R=T.indexOf(a.state.button),L=T.slice(0,R+1),se=[...T.slice(R+1),...L];for(let de of se.slice())if(de.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(de)){let Ie=se.indexOf(de);Ie!==-1&&se.splice(Ie,1)}H(se,G.First,{sorted:!1})},[A.Backwards]:()=>{var c;H(p,G.Previous)===$e.Error&&((c=a.state.button)==null||c.focus())}})}o()}),pe=re();return h.createElement(lt,null,h.createElement(ce.Provider,{value:f},h.createElement(we,{value:a.actions.refocusableClose},h.createElement(Je,{enabled:l?e.static||s:!1,ownerDocument:ne},s&&y&&h.createElement(ve,{id:P,ref:d,features:be.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Q}),pe({ourProps:Y,theirProps:C,slot:_,defaultTag:Ct,features:Bt,visible:s,name:"Popover.Panel"}),s&&y&&h.createElement(ve,{id:S,ref:v,features:be.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:le})))))}let Ot="div";function Et(e,r){let t=u.useRef(null),f=U(t,r),[b,m]=u.useState([]),l=g(d=>{m(v=>{let P=v.indexOf(d);if(P!==-1){let S=v.slice();return S.splice(P,1),S}return v})}),n=g(d=>(m(v=>[...v,d]),()=>l(d))),B=g(()=>{var d;let v=Se(t.current);if(!v)return!1;let P=oe(t.current);return(d=t.current)!=null&&d.contains(P)?!0:b.some(S=>{var i,x;return((i=v.getElementById(S.buttonId.current))==null?void 0:i.contains(P))||((x=v.getElementById(S.panelId.current))==null?void 0:x.contains(P))})}),C=g(d=>{for(let v of b)v.buttonId.current!==d&&v.close()}),a=u.useMemo(()=>({registerPopover:n,unregisterPopover:l,isFocusWithinPopoverGroup:B,closeOthers:C}),[n,l,B,C]),y=ae({}),I=e,F={ref:f},k=re();return h.createElement(xe,null,h.createElement(ye.Provider,{value:a},k({ourProps:F,theirProps:I,slot:y,defaultTag:Ot,name:"Popover.Group"})))}let Ft=J(St),kt=J(yt),wt=J(Me),Tt=J(Me),_t=J(xt),Dt=J(Et),en=Object.assign(Ft,{Button:kt,Backdrop:Tt,Overlay:wt,Panel:_t,Group:Dt});export{kt as D,_t as L,Dt as h,en as v,Tt as x};
