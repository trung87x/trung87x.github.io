import{a4 as Re,H as fe,az as Ae,aH as me,a6 as Ge,a8 as Z,r as u,aa as Ne,Y as U,I as q,o as g,aI as he,aJ as ae,n as oe,K as re,G as S,aK as Oe,ab as z,b as H,$ as Le,d as He,e as je,V as ve,aL as Ee,aB as j,aM as A,al as G,aC as be,Z as Pe,_ as $e,ac as ge,P as Ke,ad as Fe,ae as ke,ag as Ve,ah as We,an as we,aD as Ye,aG as xe,ao as Qe,aE as Ze,aN as qe,aA as Ce,aO as ze,aP as Je,aQ as Ue,aR as Xe,aq as et,af as J,as as tt,at as ue,ay as nt,ar as at,au as ot}from"./index-DoTC0ASh.js";import{F as rt,y as st,R as lt,T as ut,w as ct,A as it}from"./floating-DCAPa532.js";import{e as pt}from"./use-resolve-button-type-CU9pBceG.js";import{s as _e}from"./bugs-DGQnUURC.js";var dt=Object.defineProperty,ft=(e,o,t)=>o in e?dt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,Be=(e,o,t)=>(ft(e,typeof o!="symbol"?o+"":o,t),t),$=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))($||{}),vt=(e=>(e[e.OpenPopover=0]="OpenPopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(vt||{});let bt={0:e=>e.popoverState===0?e:{...e,popoverState:0,__demoMode:!1},1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,o){return e.button===o.button?e:{...e,button:o.button}},3(e,o){return e.buttonId===o.buttonId?e:{...e,buttonId:o.buttonId}},4(e,o){return e.panel===o.panel?e:{...e,panel:o.panel}},5(e,o){return e.panelId===o.panelId?e:{...e,panelId:o.panelId}}};class Se extends Re{constructor(o){super(o),Be(this,"actions",{close:()=>this.send({type:1}),refocusableClose:t=>{this.actions.close();let f=t?fe(t)?t:"current"in t&&fe(t.current)?t.current:this.state.button:this.state.button;f?.focus()},open:()=>this.send({type:0}),setButtonId:t=>this.send({type:3,buttonId:t}),setButton:t=>this.send({type:2,button:t}),setPanelId:t=>this.send({type:5,panelId:t}),setPanel:t=>this.send({type:4,panel:t})}),Be(this,"selectors",{isPortalled:t=>{var f;if(!t.button||!t.panel)return!1;let b=(f=Ae(t.button))!=null?f:document;for(let y of b.querySelectorAll("body > *"))if(Number(y?.contains(t.button))^Number(y?.contains(t.panel)))return!0;let P=me(b),s=P.indexOf(t.button),n=(s+P.length-1)%P.length,B=(s+1)%P.length,C=P[n],r=P[B];return!t.panel.contains(C)&&!t.panel.contains(r)}});{let t=this.state.id,f=Ge.get(null);this.on(0,()=>f.actions.push(t)),this.on(1,()=>f.actions.pop(t))}}static new({id:o,__demoMode:t=!1}){return new Se({id:o,__demoMode:t,popoverState:t?0:1,buttons:{current:[]},button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:{current:null},afterPanelSentinel:{current:null},afterButtonSentinel:{current:null}})}reduce(o,t){return Z(t.type,bt,o,t)}}const De=u.createContext(null);function ce(e){let o=u.useContext(De);if(o===null){let t=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ce),t}return o}function Pt({id:e,__demoMode:o=!1}){let t=u.useMemo(()=>Se.new({id:e,__demoMode:o}),[]);return Ne(()=>t.dispose()),t}let ye=u.createContext(null);ye.displayName="PopoverGroupContext";function Te(){return u.useContext(ye)}let ie=u.createContext(null);ie.displayName="PopoverPanelContext";function $t(){return u.useContext(ie)}let mt="div";function ht(e,o){var t;let f=u.useId(),{__demoMode:b=!1,...P}=e,s=Pt({id:f,__demoMode:b}),n=u.useRef(null),B=q(o,Ze(l=>{n.current=l})),[C,r,y,I,k]=z(s,u.useCallback(l=>[l.popoverState,l.button,l.panel,l.buttonId,l.panelId],[])),w=qe((t=n.current)!=null?t:r),d=Ce(I),v=Ce(k),m=u.useMemo(()=>({buttonId:d,panelId:v,close:s.actions.close}),[d,v,s]),h=Te(),c=h?.registerPopover,O=g(()=>{var l,E;let x=ae((l=n.current)!=null?l:r);return(E=h?.isFocusWithinPopoverGroup())!=null?E:x&&(r?.contains(x)||y?.contains(x))});u.useEffect(()=>c?.(m),[c,m]);let[X,ee]=ze(),N=Je(r),M=Ue({mainTreeNode:N,portals:X,defaultContainers:[{get current(){return s.state.button}},{get current(){return s.state.panel}}]});Xe(w,"focus",l=>{var E,x,D,Y,T,Q;l.target!==window&&nt(l.target)&&s.state.popoverState===$.Open&&(O()||s.state.button&&s.state.panel&&(M.contains(l.target)||(x=(E=s.state.beforePanelSentinel.current)==null?void 0:E.contains)!=null&&x.call(E,l.target)||(Y=(D=s.state.afterPanelSentinel.current)==null?void 0:D.contains)!=null&&Y.call(D,l.target)||(Q=(T=s.state.afterButtonSentinel.current)==null?void 0:T.contains)!=null&&Q.call(T,l.target)||s.actions.close()))},!0);let K=C===$.Open;et(K,M.resolveContainers,(l,E)=>{s.actions.close(),at(E,ot.Loose)||(l.preventDefault(),r?.focus())});let te=oe({open:C===$.Open,close:s.actions.refocusableClose}),ne=z(s,u.useCallback(l=>Z(l.popoverState,{[$.Open]:J.Open,[$.Closed]:J.Closed}),[])),V={ref:B},W=re();return S.createElement(Oe,{node:N},S.createElement(it,null,S.createElement(ie.Provider,{value:null},S.createElement(De.Provider,{value:s},S.createElement(xe,{value:s.actions.refocusableClose},S.createElement(tt,{value:ne},S.createElement(ee,null,W({ourProps:V,theirProps:P,slot:te,defaultTag:mt,name:"Popover"}))))))))}let St="button";function yt(e,o){let t=u.useId(),{id:f=`headlessui-popover-button-${t}`,disabled:b=!1,autoFocus:P=!1,...s}=e,n=ce("Popover.Button"),[B,C,r,y,I,k,w]=z(n,u.useCallback(a=>[a.popoverState,n.selectors.isPortalled(a),a.button,a.buttonId,a.panel,a.panelId,a.afterButtonSentinel],[])),d=u.useRef(null),v=`headlessui-focus-sentinel-${u.useId()}`,m=Te(),h=m?.closeOthers,c=$t()!==null;u.useEffect(()=>{if(!c)return n.actions.setButtonId(f),()=>n.actions.setButtonId(null)},[c,f,n]);let[O]=u.useState(()=>Symbol()),X=q(d,o,rt(),g(a=>{if(!c){if(a)n.state.buttons.current.push(O);else{let i=n.state.buttons.current.indexOf(O);i!==-1&&n.state.buttons.current.splice(i,1)}n.state.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),a&&n.actions.setButton(a)}})),ee=q(d,o),N=g(a=>{var i,F,_;if(c){if(n.state.popoverState===$.Closed)return;switch(a.key){case H.Space:case H.Enter:a.preventDefault(),(F=(i=a.target).click)==null||F.call(i),n.actions.close(),(_=n.state.button)==null||_.focus();break}}else switch(a.key){case H.Space:case H.Enter:a.preventDefault(),a.stopPropagation(),n.state.popoverState===$.Closed?(h?.(n.state.buttonId),n.actions.open()):n.actions.close();break;case H.Escape:if(n.state.popoverState!==$.Open)return h?.(n.state.buttonId);if(!d.current)return;let R=ae(d.current);if(R&&!d.current.contains(R))return;a.preventDefault(),a.stopPropagation(),n.actions.close();break}}),M=g(a=>{c||a.key===H.Space&&a.preventDefault()}),K=g(a=>{var i,F;_e(a.currentTarget)||b||(c?(n.actions.close(),(i=n.state.button)==null||i.focus()):(a.preventDefault(),a.stopPropagation(),n.state.popoverState===$.Closed?(h?.(n.state.buttonId),n.actions.open()):n.actions.close(),(F=n.state.button)==null||F.focus()))}),te=g(a=>{a.preventDefault(),a.stopPropagation()}),{isFocusVisible:ne,focusProps:V}=Le({autoFocus:P}),{isHovered:W,hoverProps:l}=He({isDisabled:b}),{pressed:E,pressProps:x}=je({disabled:b}),D=B===$.Open,Y=oe({open:D,active:E||D,disabled:b,hover:W,focus:ne,autofocus:P}),T=pt(e,r),Q=c?ve({ref:ee,type:T,onKeyDown:N,onClick:K,disabled:b||void 0,autoFocus:P},V,l,x):ve({ref:X,id:y,type:T,"aria-expanded":B===$.Open,"aria-controls":I?k:void 0,disabled:b||void 0,autoFocus:P,onKeyDown:N,onKeyUp:M,onClick:K,onMouseDown:te},V,l,x),se=Ee(),pe=g(()=>{if(!fe(n.state.panel))return;let a=n.state.panel;function i(){Z(se.current,{[A.Forwards]:()=>j(a,G.First),[A.Backwards]:()=>j(a,G.Last)})===be.Error&&j(me(he(n.state.button)).filter(F=>F.dataset.headlessuiFocusGuard!=="true"),Z(se.current,{[A.Forwards]:G.Next,[A.Backwards]:G.Previous}),{relativeTo:n.state.button})}i()}),p=re();return S.createElement(S.Fragment,null,p({ourProps:Q,theirProps:s,slot:Y,defaultTag:St,name:"Popover.Button"}),D&&!c&&C&&S.createElement(Pe,{id:v,ref:w,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:pe}))}let It="div",gt=ue.RenderStrategy|ue.Static;function Me(e,o){let t=u.useId(),{id:f=`headlessui-popover-backdrop-${t}`,transition:b=!1,...P}=e,s=ce("Popover.Backdrop"),n=z(s,u.useCallback(m=>m.popoverState,[])),[B,C]=u.useState(null),r=q(o,C),y=Fe(),[I,k]=ke(b,B,y!==null?(y&J.Open)===J.Open:n===$.Open),w=g(m=>{if(_e(m.currentTarget))return m.preventDefault();s.actions.close()}),d=oe({open:n===$.Open}),v={ref:r,id:f,"aria-hidden":!0,onClick:w,...we(k)};return re()({ourProps:v,theirProps:P,slot:d,defaultTag:It,features:gt,visible:I,name:"Popover.Backdrop"})}let Ct="div",Bt=ue.RenderStrategy|ue.Static;function Ot(e,o){let t=u.useId(),{id:f=`headlessui-popover-panel-${t}`,focus:b=!1,anchor:P,portal:s=!1,modal:n=!1,transition:B=!1,...C}=e,r=ce("Popover.Panel"),y=z(r,r.selectors.isPortalled),[I,k,w,d,v]=z(r,u.useCallback(p=>[p.popoverState,p.button,p.__demoMode,p.beforePanelSentinel,p.afterPanelSentinel],[])),m=`headlessui-focus-sentinel-before-${t}`,h=`headlessui-focus-sentinel-after-${t}`,c=u.useRef(null),O=st(P),[X,ee]=lt(O),N=ut();O&&(s=!0);let[M,K]=u.useState(null),te=q(c,o,O?X:null,r.actions.setPanel,K),ne=ge(k),V=ge(c.current);Ke(()=>(r.actions.setPanelId(f),()=>r.actions.setPanelId(null)),[f,r]);let W=Fe(),[l,E]=ke(B,M,W!==null?(W&J.Open)===J.Open:I===$.Open);Ve(l,k,r.actions.close),We(w?!1:n&&l,V);let x=g(p=>{var a;switch(p.key){case H.Escape:if(r.state.popoverState!==$.Open||!c.current)return;let i=ae(c.current);if(i&&!c.current.contains(i))return;p.preventDefault(),p.stopPropagation(),r.actions.close(),(a=r.state.button)==null||a.focus();break}});u.useEffect(()=>{var p;e.static||I===$.Closed&&((p=e.unmount)==null||p)&&r.actions.setPanel(null)},[I,e.unmount,e.static,r]),u.useEffect(()=>{if(w||!b||I!==$.Open||!c.current)return;let p=ae(c.current);c.current.contains(p)||j(c.current,G.First)},[w,b,c.current,I]);let D=oe({open:I===$.Open,close:r.actions.refocusableClose}),Y=ve(O?N():{},{ref:te,id:f,onKeyDown:x,onBlur:b&&I===$.Open?p=>{var a,i,F,_,R;let L=p.relatedTarget;L&&c.current&&((a=c.current)!=null&&a.contains(L)||(r.actions.close(),((F=(i=d.current)==null?void 0:i.contains)!=null&&F.call(i,L)||(R=(_=v.current)==null?void 0:_.contains)!=null&&R.call(_,L))&&L.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...C.style,...ee,"--button-width":ct(l,k,!0).width},...we(E)}),T=Ee(),Q=g(()=>{let p=c.current;if(!p)return;function a(){Z(T.current,{[A.Forwards]:()=>{var i;j(p,G.First)===be.Error&&((i=r.state.afterPanelSentinel.current)==null||i.focus())},[A.Backwards]:()=>{var i;(i=r.state.button)==null||i.focus({preventScroll:!0})}})}a()}),se=g(()=>{let p=c.current;if(!p)return;function a(){Z(T.current,{[A.Forwards]:()=>{var i;if(!r.state.button)return;let F=(i=he(r.state.button))!=null?i:document.body,_=me(F),R=_.indexOf(r.state.button),L=_.slice(0,R+1),le=[..._.slice(R+1),...L];for(let de of le.slice())if(de.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(de)){let Ie=le.indexOf(de);Ie!==-1&&le.splice(Ie,1)}j(le,G.First,{sorted:!1})},[A.Backwards]:()=>{var i;j(p,G.Previous)===be.Error&&((i=r.state.button)==null||i.focus())}})}a()}),pe=re();return S.createElement(Ye,null,S.createElement(ie.Provider,{value:f},S.createElement(xe,{value:r.actions.refocusableClose},S.createElement(Qe,{enabled:s?e.static||l:!1,ownerDocument:ne},l&&y&&S.createElement(Pe,{id:m,ref:d,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Q}),pe({ourProps:Y,theirProps:C,slot:D,defaultTag:Ct,features:Bt,visible:l,name:"Popover.Panel"}),l&&y&&S.createElement(Pe,{id:h,ref:v,features:$e.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:se})))))}let Et="div";function Ft(e,o){let t=u.useRef(null),f=q(t,o),[b,P]=u.useState([]),s=g(d=>{P(v=>{let m=v.indexOf(d);if(m!==-1){let h=v.slice();return h.splice(m,1),h}return v})}),n=g(d=>(P(v=>[...v,d]),()=>s(d))),B=g(()=>{var d;let v=he(t.current);if(!v)return!1;let m=ae(t.current);return(d=t.current)!=null&&d.contains(m)?!0:b.some(h=>{var c,O;return((c=v.getElementById(h.buttonId.current))==null?void 0:c.contains(m))||((O=v.getElementById(h.panelId.current))==null?void 0:O.contains(m))})}),C=g(d=>{for(let v of b)v.buttonId.current!==d&&v.close()}),r=u.useMemo(()=>({registerPopover:n,unregisterPopover:s,isFocusWithinPopoverGroup:B,closeOthers:C}),[n,s,B,C]),y=oe({}),I=e,k={ref:f},w=re();return S.createElement(Oe,null,S.createElement(ye.Provider,{value:r},w({ourProps:k,theirProps:I,slot:y,defaultTag:Et,name:"Popover.Group"})))}let kt=U(ht),wt=U(yt),xt=U(Me),_t=U(Me),Dt=U(Ot),Tt=U(Ft),Nt=Object.assign(kt,{Button:wt,Backdrop:_t,Overlay:xt,Panel:Dt,Group:Tt});export{wt as D,Dt as L,Tt as h,Nt as v,_t as x};
