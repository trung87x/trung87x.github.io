import{$ as Re,a as Ae}from"./useFocusRing-f27ekapY.js";import{r as u,G as h}from"./index-Cfbom0r9.js";import{w as Ge,e as Ne}from"./use-resolve-button-type-nCEFKAW6.js";import{F as Le,y as je,R as He,T as Ke,w as Ve,A as We}from"./floating-RB7slPpe.js";import{u as Z,Y as J,y as q,o as g,K as re,V as fe,n as Ye,T as Qe,c as ge,A as ue}from"./use-sync-refs-CwDvttRH.js";import{E as Ze}from"./use-event-listener-CFzRUhH6.js";import{T as qe,x as Ue,c as ze,S as U,u as Ce,p as Je,f as Xe,t as et,d as tt,e as nt,k as ot}from"./portal-CArIgIsl.js";import{j as xe,u as Oe,x as rt,S as at,a as A}from"./use-tab-direction-DCUe_egR.js";import{n as ve,l as lt,a as ae,f as oe,r as Pe,o as j,i as st}from"./keyboard-Bur1hHA-.js";import{u as Ee,N as Fe,x as ke,s as ut,i as z,c as ct}from"./open-closed-D9YH7Kvg.js";import{C as we}from"./close-provider-CBais-0d.js";import{f as be,s as me}from"./hidden-DGdeukVa.js";import{s as Te}from"./bugs-CmbuA3lI.js";import{x as Se,v as H,T as G,A as $e,H as it,I as pt}from"./focus-management-D1Fc7qVe.js";var dt=Object.defineProperty,ft=(e,r,t)=>r in e?dt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Be=(e,r,t)=>(ft(e,typeof r!="symbol"?r+"":r,t),t),$=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))($||{}),vt=(e=>(e[e.OpenPopover=0]="OpenPopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(vt||{});let bt={0:e=>e.popoverState===0?e:{...e,popoverState:0,__demoMode:!1},1(e){return e.popoverState===1?e:{...e,popoverState:1,__demoMode:!1}},2(e,r){return e.button===r.button?e:{...e,button:r.button}},3(e,r){return e.buttonId===r.buttonId?e:{...e,buttonId:r.buttonId}},4(e,r){return e.panel===r.panel?e:{...e,panel:r.panel}},5(e,r){return e.panelId===r.panelId?e:{...e,panelId:r.panelId}}};class he extends qe{constructor(r){super(r),Be(this,"actions",{close:()=>this.send({type:1}),refocusableClose:t=>{this.actions.close();let f=t?ve(t)?t:"current"in t&&ve(t.current)?t.current:this.state.button:this.state.button;f?.focus()},open:()=>this.send({type:0}),setButtonId:t=>this.send({type:3,buttonId:t}),setButton:t=>this.send({type:2,button:t}),setPanelId:t=>this.send({type:5,panelId:t}),setPanel:t=>this.send({type:4,panel:t})}),Be(this,"selectors",{isPortalled:t=>{var f;if(!t.button||!t.panel)return!1;let b=(f=lt(t.button))!=null?f:document;for(let y of b.querySelectorAll("body > *"))if(Number(y?.contains(t.button))^Number(y?.contains(t.panel)))return!0;let m=Se(b),l=m.indexOf(t.button),n=(l+m.length-1)%m.length,B=(l+1)%m.length,C=m[n],a=m[B];return!t.panel.contains(C)&&!t.panel.contains(a)}});{let t=this.state.id,f=Ue.get(null);this.on(0,()=>f.actions.push(t)),this.on(1,()=>f.actions.pop(t))}}static new({id:r,__demoMode:t=!1}){return new he({id:r,__demoMode:t,popoverState:t?0:1,buttons:{current:[]},button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:{current:null},afterPanelSentinel:{current:null},afterButtonSentinel:{current:null}})}reduce(r,t){return Z(t.type,bt,r,t)}}const _e=u.createContext(null);function ce(e){let r=u.useContext(_e);if(r===null){let t=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ce),t}return r}function mt({id:e,__demoMode:r=!1}){let t=u.useMemo(()=>he.new({id:e,__demoMode:r}),[]);return ze(()=>t.dispose()),t}let ye=u.createContext(null);ye.displayName="PopoverGroupContext";function De(){return u.useContext(ye)}let ie=u.createContext(null);ie.displayName="PopoverPanelContext";function $t(){return u.useContext(ie)}let Pt="div";function St(e,r){var t;let f=u.useId(),{__demoMode:b=!1,...m}=e,l=mt({id:f,__demoMode:b}),n=u.useRef(null),B=q(r,Qe(s=>{n.current=s})),[C,a,y,I,F]=U(l,u.useCallback(s=>[s.popoverState,s.button,s.panel,s.buttonId,s.panelId],[])),k=tt((t=n.current)!=null?t:a),d=ge(I),v=ge(F),P=u.useMemo(()=>({buttonId:d,panelId:v,close:l.actions.close}),[d,v,l]),S=De(),c=S?.registerPopover,x=g(()=>{var s,O;let w=oe((s=n.current)!=null?s:a);return(O=S?.isFocusWithinPopoverGroup())!=null?O:w&&(a?.contains(w)||y?.contains(w))});u.useEffect(()=>c?.(P),[c,P]);let[X,ee]=nt(),N=rt(a),M=at({mainTreeNode:N,portals:X,defaultContainers:[{get current(){return l.state.button}},{get current(){return l.state.panel}}]});Ze(k,"focus",s=>{var O,w,_,Y,D,Q;s.target!==window&&st(s.target)&&l.state.popoverState===$.Open&&(x()||l.state.button&&l.state.panel&&(M.contains(s.target)||(w=(O=l.state.beforePanelSentinel.current)==null?void 0:O.contains)!=null&&w.call(O,s.target)||(Y=(_=l.state.afterPanelSentinel.current)==null?void 0:_.contains)!=null&&Y.call(_,s.target)||(Q=(D=l.state.afterButtonSentinel.current)==null?void 0:D.contains)!=null&&Q.call(D,s.target)||l.actions.close()))},!0);let K=C===$.Open;ot(K,M.resolveContainers,(s,O)=>{l.actions.close(),it(O,pt.Loose)||(s.preventDefault(),a?.focus())});let te=ae({open:C===$.Open,close:l.actions.refocusableClose}),ne=U(l,u.useCallback(s=>Z(s.popoverState,{[$.Open]:z.Open,[$.Closed]:z.Closed}),[])),V={ref:B},W=re();return h.createElement(xe,{node:N},h.createElement(We,null,h.createElement(ie.Provider,{value:null},h.createElement(_e.Provider,{value:l},h.createElement(we,{value:l.actions.refocusableClose},h.createElement(ct,{value:ne},h.createElement(ee,null,W({ourProps:V,theirProps:m,slot:te,defaultTag:Pt,name:"Popover"}))))))))}let ht="button";function yt(e,r){let t=u.useId(),{id:f=`headlessui-popover-button-${t}`,disabled:b=!1,autoFocus:m=!1,...l}=e,n=ce("Popover.Button"),[B,C,a,y,I,F,k]=U(n,u.useCallback(o=>[o.popoverState,n.selectors.isPortalled(o),o.button,o.buttonId,o.panel,o.panelId,o.afterButtonSentinel],[])),d=u.useRef(null),v=`headlessui-focus-sentinel-${u.useId()}`,P=De(),S=P?.closeOthers,c=$t()!==null;u.useEffect(()=>{if(!c)return n.actions.setButtonId(f),()=>n.actions.setButtonId(null)},[c,f,n]);let[x]=u.useState(()=>Symbol()),X=q(d,r,Le(),g(o=>{if(!c){if(o)n.state.buttons.current.push(x);else{let i=n.state.buttons.current.indexOf(x);i!==-1&&n.state.buttons.current.splice(i,1)}n.state.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),o&&n.actions.setButton(o)}})),ee=q(d,r),N=g(o=>{var i,E,T;if(c){if(n.state.popoverState===$.Closed)return;switch(o.key){case j.Space:case j.Enter:o.preventDefault(),(E=(i=o.target).click)==null||E.call(i),n.actions.close(),(T=n.state.button)==null||T.focus();break}}else switch(o.key){case j.Space:case j.Enter:o.preventDefault(),o.stopPropagation(),n.state.popoverState===$.Closed?(S?.(n.state.buttonId),n.actions.open()):n.actions.close();break;case j.Escape:if(n.state.popoverState!==$.Open)return S?.(n.state.buttonId);if(!d.current)return;let R=oe(d.current);if(R&&!d.current.contains(R))return;o.preventDefault(),o.stopPropagation(),n.actions.close();break}}),M=g(o=>{c||o.key===j.Space&&o.preventDefault()}),K=g(o=>{var i,E;Te(o.currentTarget)||b||(c?(n.actions.close(),(i=n.state.button)==null||i.focus()):(o.preventDefault(),o.stopPropagation(),n.state.popoverState===$.Closed?(S?.(n.state.buttonId),n.actions.open()):n.actions.close(),(E=n.state.button)==null||E.focus()))}),te=g(o=>{o.preventDefault(),o.stopPropagation()}),{isFocusVisible:ne,focusProps:V}=Re({autoFocus:m}),{isHovered:W,hoverProps:s}=Ae({isDisabled:b}),{pressed:O,pressProps:w}=Ge({disabled:b}),_=B===$.Open,Y=ae({open:_,active:O||_,disabled:b,hover:W,focus:ne,autofocus:m}),D=Ne(e,a),Q=c?fe({ref:ee,type:D,onKeyDown:N,onClick:K,disabled:b||void 0,autoFocus:m},V,s,w):fe({ref:X,id:y,type:D,"aria-expanded":B===$.Open,"aria-controls":I?F:void 0,disabled:b||void 0,autoFocus:m,onKeyDown:N,onKeyUp:M,onClick:K,onMouseDown:te},V,s,w),le=Oe(),pe=g(()=>{if(!ve(n.state.panel))return;let o=n.state.panel;function i(){Z(le.current,{[A.Forwards]:()=>H(o,G.First),[A.Backwards]:()=>H(o,G.Last)})===$e.Error&&H(Se(Pe(n.state.button)).filter(E=>E.dataset.headlessuiFocusGuard!=="true"),Z(le.current,{[A.Forwards]:G.Next,[A.Backwards]:G.Previous}),{relativeTo:n.state.button})}i()}),p=re();return h.createElement(h.Fragment,null,p({ourProps:Q,theirProps:l,slot:Y,defaultTag:ht,name:"Popover.Button"}),_&&!c&&C&&h.createElement(be,{id:v,ref:k,features:me.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:pe}))}let It="div",gt=ue.RenderStrategy|ue.Static;function Me(e,r){let t=u.useId(),{id:f=`headlessui-popover-backdrop-${t}`,transition:b=!1,...m}=e,l=ce("Popover.Backdrop"),n=U(l,u.useCallback(P=>P.popoverState,[])),[B,C]=u.useState(null),a=q(r,C),y=Ee(),[I,F]=Fe(b,B,y!==null?(y&z.Open)===z.Open:n===$.Open),k=g(P=>{if(Te(P.currentTarget))return P.preventDefault();l.actions.close()}),d=ae({open:n===$.Open}),v={ref:a,id:f,"aria-hidden":!0,onClick:k,...ke(F)};return re()({ourProps:v,theirProps:m,slot:d,defaultTag:It,features:gt,visible:I,name:"Popover.Backdrop"})}let Ct="div",Bt=ue.RenderStrategy|ue.Static;function xt(e,r){let t=u.useId(),{id:f=`headlessui-popover-panel-${t}`,focus:b=!1,anchor:m,portal:l=!1,modal:n=!1,transition:B=!1,...C}=e,a=ce("Popover.Panel"),y=U(a,a.selectors.isPortalled),[I,F,k,d,v]=U(a,u.useCallback(p=>[p.popoverState,p.button,p.__demoMode,p.beforePanelSentinel,p.afterPanelSentinel],[])),P=`headlessui-focus-sentinel-before-${t}`,S=`headlessui-focus-sentinel-after-${t}`,c=u.useRef(null),x=je(m),[X,ee]=He(x),N=Ke();x&&(l=!0);let[M,K]=u.useState(null),te=q(c,r,x?X:null,a.actions.setPanel,K),ne=Ce(F),V=Ce(c.current);Ye(()=>(a.actions.setPanelId(f),()=>a.actions.setPanelId(null)),[f,a]);let W=Ee(),[s,O]=Fe(B,M,W!==null?(W&z.Open)===z.Open:I===$.Open);Je(s,F,a.actions.close),Xe(k?!1:n&&s,V);let w=g(p=>{var o;switch(p.key){case j.Escape:if(a.state.popoverState!==$.Open||!c.current)return;let i=oe(c.current);if(i&&!c.current.contains(i))return;p.preventDefault(),p.stopPropagation(),a.actions.close(),(o=a.state.button)==null||o.focus();break}});u.useEffect(()=>{var p;e.static||I===$.Closed&&((p=e.unmount)==null||p)&&a.actions.setPanel(null)},[I,e.unmount,e.static,a]),u.useEffect(()=>{if(k||!b||I!==$.Open||!c.current)return;let p=oe(c.current);c.current.contains(p)||H(c.current,G.First)},[k,b,c.current,I]);let _=ae({open:I===$.Open,close:a.actions.refocusableClose}),Y=fe(x?N():{},{ref:te,id:f,onKeyDown:w,onBlur:b&&I===$.Open?p=>{var o,i,E,T,R;let L=p.relatedTarget;L&&c.current&&((o=c.current)!=null&&o.contains(L)||(a.actions.close(),((E=(i=d.current)==null?void 0:i.contains)!=null&&E.call(i,L)||(R=(T=v.current)==null?void 0:T.contains)!=null&&R.call(T,L))&&L.focus({preventScroll:!0})))}:void 0,tabIndex:-1,style:{...C.style,...ee,"--button-width":Ve(s,F,!0).width},...ke(O)}),D=Oe(),Q=g(()=>{let p=c.current;if(!p)return;function o(){Z(D.current,{[A.Forwards]:()=>{var i;H(p,G.First)===$e.Error&&((i=a.state.afterPanelSentinel.current)==null||i.focus())},[A.Backwards]:()=>{var i;(i=a.state.button)==null||i.focus({preventScroll:!0})}})}o()}),le=g(()=>{let p=c.current;if(!p)return;function o(){Z(D.current,{[A.Forwards]:()=>{var i;if(!a.state.button)return;let E=(i=Pe(a.state.button))!=null?i:document.body,T=Se(E),R=T.indexOf(a.state.button),L=T.slice(0,R+1),se=[...T.slice(R+1),...L];for(let de of se.slice())if(de.dataset.headlessuiFocusGuard==="true"||M!=null&&M.contains(de)){let Ie=se.indexOf(de);Ie!==-1&&se.splice(Ie,1)}H(se,G.First,{sorted:!1})},[A.Backwards]:()=>{var i;H(p,G.Previous)===$e.Error&&((i=a.state.button)==null||i.focus())}})}o()}),pe=re();return h.createElement(ut,null,h.createElement(ie.Provider,{value:f},h.createElement(we,{value:a.actions.refocusableClose},h.createElement(et,{enabled:l?e.static||s:!1,ownerDocument:ne},s&&y&&h.createElement(be,{id:P,ref:d,features:me.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Q}),pe({ourProps:Y,theirProps:C,slot:_,defaultTag:Ct,features:Bt,visible:s,name:"Popover.Panel"}),s&&y&&h.createElement(be,{id:S,ref:v,features:me.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:le})))))}let Ot="div";function Et(e,r){let t=u.useRef(null),f=q(t,r),[b,m]=u.useState([]),l=g(d=>{m(v=>{let P=v.indexOf(d);if(P!==-1){let S=v.slice();return S.splice(P,1),S}return v})}),n=g(d=>(m(v=>[...v,d]),()=>l(d))),B=g(()=>{var d;let v=Pe(t.current);if(!v)return!1;let P=oe(t.current);return(d=t.current)!=null&&d.contains(P)?!0:b.some(S=>{var c,x;return((c=v.getElementById(S.buttonId.current))==null?void 0:c.contains(P))||((x=v.getElementById(S.panelId.current))==null?void 0:x.contains(P))})}),C=g(d=>{for(let v of b)v.buttonId.current!==d&&v.close()}),a=u.useMemo(()=>({registerPopover:n,unregisterPopover:l,isFocusWithinPopoverGroup:B,closeOthers:C}),[n,l,B,C]),y=ae({}),I=e,F={ref:f},k=re();return h.createElement(xe,null,h.createElement(ye.Provider,{value:a},k({ourProps:F,theirProps:I,slot:y,defaultTag:Ot,name:"Popover.Group"})))}let Ft=J(St),kt=J(yt),wt=J(Me),Tt=J(Me),_t=J(xt),Dt=J(Et),qt=Object.assign(Ft,{Button:kt,Backdrop:Tt,Overlay:wt,Panel:_t,Group:Dt});export{kt as D,_t as L,Dt as h,qt as v,Tt as x};
