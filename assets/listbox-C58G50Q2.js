import{$ as Le,a as we}from"./useFocusRing-DyhHL-Bs.js";import{r as v,G as M}from"./index-_abZp7Jz.js";import{r as ce}from"./index-CNbDW8mT.js";import{w as Me,e as ke}from"./use-resolve-button-type-CIOT3Wqy.js";import{u as Te}from"./use-by-comparator-COnH_sKZ.js";import{g as Ce,l as De,b as Ae,j as Fe}from"./form-fields-ZG9TL2Bl.js";import{u as H,Y as q,y as j,o as F,V as ge,K as W,p as _e,c as Ne,n as de,d as Ve,A as ve}from"./use-sync-refs-c_sb9ZsK.js";import{F as Be,b as ze,y as Qe,R as Ue,T as He,w as Ke,A as Ge}from"./floating-BA_BpZJ-.js";import{p as qe,c as ee,a as h,f as J,b as je,L as We,S as X,s as Ye,u as Ze}from"./element-movement-DnDI8Y0o.js";import{y as Je}from"./use-inert-others-_yLbDgCZ.js";import{T as Xe,a as ue,x as Oe,b as et,c as tt,S as E,u as me,p as ot,f as nt,t as it,k as st}from"./portal-DeqkkDyL.js";import{n as at,o as O,a as K,d as rt}from"./keyboard-Bz6YqB5p.js";import{s as lt}from"./use-text-value-DGoznkzl.js";import{u as ut,N as ct,i as oe,x as dt,c as pt}from"./open-closed-DGXjgVGF.js";import{w as ft,a as vt}from"./description-DIgj0oO8.js";import{u as mt}from"./frozen-CtME1SOA.js";import{Z as bt,u as ht,N as xt,V as gt}from"./label-DM5jETA3.js";import{G as Ot,R as St,T as be,H as $t,I as It}from"./focus-management-BfeCmB8q.js";var yt=Object.defineProperty,Et=(e,i,t)=>i in e?yt(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,he=(e,i,t)=>(Et(e,typeof i!="symbol"?i+"":i,t),t),S=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(S||{}),B=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(B||{}),te=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(te||{}),Se=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.SelectOption=5]="SelectOption",e[e.RegisterOptions=6]="RegisterOptions",e[e.UnregisterOptions=7]="UnregisterOptions",e[e.SetButtonElement=8]="SetButtonElement",e[e.SetOptionsElement=9]="SetOptionsElement",e[e.SortOptions=10]="SortOptions",e[e.MarkButtonAsMoved=11]="MarkButtonAsMoved",e))(Se||{});function xe(e,i=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=Ot(i(e.options.slice()),s=>s.dataRef.current.domRef.current),n=t?o.indexOf(t):null;return n===-1&&(n=null),{options:o,activeOptionIndex:n}}let Rt={1(e){if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.buttonElement?ee.Tracked(je(e.buttonElement)):e.buttonPositionState;return{...e,activeOptionIndex:null,pendingFocus:{focus:h.Nothing},listboxState:1,__demoMode:!1,buttonPositionState:i}},0(e,i){if(e.dataRef.current.disabled||e.listboxState===0)return e;let t=e.activeOptionIndex,{isSelected:o}=e.dataRef.current,n=e.options.findIndex(s=>o(s.dataRef.current.value));return n!==-1&&(t=n),{...e,frozenValue:!1,pendingFocus:i.focus,listboxState:0,activeOptionIndex:t,__demoMode:!1,buttonPositionState:ee.Idle}},2(e,i){var t,o,n,s,d;if(e.dataRef.current.disabled||e.listboxState===1)return e;let c={...e,searchQuery:"",activationTrigger:(t=i.trigger)!=null?t:1,__demoMode:!1};if(i.focus===h.Nothing)return{...c,activeOptionIndex:null};if(i.focus===h.Specific)return{...c,activeOptionIndex:e.options.findIndex(m=>m.id===i.id)};if(i.focus===h.Previous){let m=e.activeOptionIndex;if(m!==null){let g=e.options[m].dataRef.current.domRef,u=J(i,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});if(u!==null){let a=e.options[u].dataRef.current.domRef;if(((o=g.current)==null?void 0:o.previousElementSibling)===a.current||((n=a.current)==null?void 0:n.previousElementSibling)===null)return{...c,activeOptionIndex:u}}}}else if(i.focus===h.Next){let m=e.activeOptionIndex;if(m!==null){let g=e.options[m].dataRef.current.domRef,u=J(i,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});if(u!==null){let a=e.options[u].dataRef.current.domRef;if(((s=g.current)==null?void 0:s.nextElementSibling)===a.current||((d=a.current)==null?void 0:d.nextElementSibling)===null)return{...c,activeOptionIndex:u}}}}let b=xe(e),l=J(i,{resolveItems:()=>b.options,resolveActiveIndex:()=>b.activeOptionIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});return{...c,...b,activeOptionIndex:l}},3:(e,i)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let t=e.searchQuery!==""?0:1,o=e.searchQuery+i.value.toLowerCase(),n=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+t).concat(e.options.slice(0,e.activeOptionIndex+t)):e.options).find(d=>{var c;return!d.dataRef.current.disabled&&((c=d.dataRef.current.textValue)==null?void 0:c.startsWith(o))}),s=n?e.options.indexOf(n):-1;return s===-1||s===e.activeOptionIndex?{...e,searchQuery:o}:{...e,searchQuery:o,activeOptionIndex:s,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5(e){return e.dataRef.current.mode===0?{...e,frozenValue:!0}:{...e}},6:(e,i)=>{let t=e.options.concat(i.options),o=e.activeOptionIndex;if(e.pendingFocus.focus!==h.Nothing&&(o=J(e.pendingFocus,{resolveItems:()=>t,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:n=>n.id,resolveDisabled:n=>n.dataRef.current.disabled})),e.activeOptionIndex===null){let{isSelected:n}=e.dataRef.current;if(n){let s=t.findIndex(d=>n?.(d.dataRef.current.value));s!==-1&&(o=s)}}return{...e,options:t,activeOptionIndex:o,pendingFocus:{focus:h.Nothing},pendingShouldSort:!0}},7:(e,i)=>{let t=e.options,o=[],n=new Set(i.options);for(let[s,d]of t.entries())if(n.has(d.id)&&(o.push(s),n.delete(d.id),n.size===0))break;if(o.length>0){t=t.slice();for(let s of o.reverse())t.splice(s,1)}return{...e,options:t,activationTrigger:1}},8:(e,i)=>e.buttonElement===i.element?e:{...e,buttonElement:i.element},9:(e,i)=>e.optionsElement===i.element?e:{...e,optionsElement:i.element},10:e=>e.pendingShouldSort?{...e,...xe(e),pendingShouldSort:!1}:e,11(e){return e.buttonPositionState.kind!=="Tracked"?e:{...e,buttonPositionState:ee.Moved}}};class pe extends Xe{constructor(i){super(i),he(this,"actions",{onChange:t=>{let{onChange:o,compare:n,mode:s,value:d}=this.state.dataRef.current;return H(s,{0:()=>o?.(t),1:()=>{let c=d.slice(),b=c.findIndex(l=>n(l,t));return b===-1?c.push(t):c.splice(b,1),o?.(c)}})},registerOption:ue(()=>{let t=[],o=new Set;return[(n,s)=>{o.has(s)||(o.add(s),t.push({id:n,dataRef:s}))},()=>(o.clear(),this.send({type:6,options:t.splice(0)}))]}),unregisterOption:ue(()=>{let t=[];return[o=>t.push(o),()=>{this.send({type:7,options:t.splice(0)})}]}),goToOption:ue(()=>{let t=null;return[(o,n)=>{t={type:2,...o,trigger:n}},()=>t&&this.send(t)]}),closeListbox:()=>{this.send({type:1})},openListbox:t=>{this.send({type:0,focus:t})},selectActiveOption:()=>{var t;if(this.state.activeOptionIndex!==null){let{dataRef:o}=this.state.options[this.state.activeOptionIndex];this.actions.selectOption(o.current.value)}else this.state.dataRef.current.mode===0&&(this.actions.closeListbox(),(t=this.state.buttonElement)==null||t.focus({preventScroll:!0}))},selectOption:t=>{this.send({type:5,value:t})},search:t=>{this.send({type:3,value:t})},clearSearch:()=>{this.send({type:4})},setButtonElement:t=>{this.send({type:8,element:t})},setOptionsElement:t=>{this.send({type:9,element:t})}}),he(this,"selectors",{activeDescendantId(t){var o;let n=t.activeOptionIndex,s=t.options;return n===null||(o=s[n])==null?void 0:o.id},isActive(t,o){var n;let s=t.activeOptionIndex,d=t.options;return s!==null?((n=d[s])==null?void 0:n.id)===o:!1},hasFrozenValue(t){return t.frozenValue},shouldScrollIntoView(t,o){return t.__demoMode||t.listboxState!==0||t.activationTrigger===0?!1:this.isActive(t,o)},didButtonMove(t){return t.buttonPositionState.kind==="Moved"}}),this.on(6,()=>{requestAnimationFrame(()=>{this.send({type:10})})});{let t=this.state.id,o=Oe.get(null);this.disposables.add(o.on(et.Push,n=>{!o.selectors.isTop(n,t)&&this.state.listboxState===0&&this.actions.closeListbox()})),this.on(0,()=>o.actions.push(t)),this.on(1,()=>o.actions.pop(t))}this.disposables.group(t=>{this.on(1,o=>{o.buttonElement&&(t.dispose(),t.add(qe(o.buttonElement,o.buttonPositionState,()=>{this.send({type:11})})))})}),this.on(5,(t,o)=>{var n;this.actions.onChange(o.value),this.state.dataRef.current.mode===0&&(this.actions.closeListbox(),(n=this.state.buttonElement)==null||n.focus({preventScroll:!0}))})}static new({id:i,__demoMode:t=!1}){return new pe({id:i,dataRef:{current:{}},listboxState:t?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,buttonElement:null,optionsElement:null,pendingShouldSort:!1,pendingFocus:{focus:h.Nothing},frozenValue:!1,__demoMode:t,buttonPositionState:ee.Idle})}reduce(i,t){return H(t.type,Rt,i,t)}}const $e=v.createContext(null);function fe(e){let i=v.useContext($e);if(i===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Ie),t}return i}function Ie({id:e,__demoMode:i=!1}){let t=v.useMemo(()=>pe.new({id:e,__demoMode:i}),[]);return tt(()=>t.dispose()),t}let ne=v.createContext(null);ne.displayName="ListboxDataContext";function Y(e){let i=v.useContext(ne);if(i===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Y),t}return i}let Pt=v.Fragment;function Lt(e,i){let t=v.useId(),o=vt(),{value:n,defaultValue:s,form:d,name:c,onChange:b,by:l,invalid:m=!1,disabled:g=o||!1,horizontal:u=!1,multiple:a=!1,__demoMode:x=!1,...L}=e;const R=u?"horizontal":"vertical";let _=j(i),k=De(s),[$=a?[]:void 0,P]=Ae(n,b,k),I=Ie({id:t,__demoMode:x}),N=v.useRef({static:!1,hold:!1}),z=v.useRef(new Map),T=Te(l),Q=v.useCallback(y=>H(p.mode,{[B.Multi]:()=>$.some(G=>T(G,y)),[B.Single]:()=>T($,y)}),[$]),p=K({value:$,disabled:g,invalid:m,mode:a?B.Multi:B.Single,orientation:R,onChange:P,compare:T,isSelected:Q,optionsPropsRef:N,listRef:z});de(()=>{I.state.dataRef.current=p},[p]);let w=E(I,y=>y.listboxState),C=Oe.get(null),U=E(C,v.useCallback(y=>C.selectors.isTop(y,t),[C,t])),[D,f]=E(I,y=>[y.buttonElement,y.optionsElement]);st(U,[D,f],(y,G)=>{I.send({type:Se.CloseListbox}),$t(G,It.Loose)||(y.preventDefault(),D?.focus())});let A=K({open:w===S.Open,disabled:g,invalid:m,value:$}),[ie,se]=gt({inherit:!0}),Z={ref:_},ae=v.useCallback(()=>{if(k!==void 0)return P?.(k)},[P,k]),re=W();return M.createElement(se,{value:ie,props:{htmlFor:D?.id},slot:{open:w===S.Open,disabled:g}},M.createElement(Ge,null,M.createElement($e.Provider,{value:I},M.createElement(ne.Provider,{value:p},M.createElement(pt,{value:H(w,{[S.Open]:oe.Open,[S.Closed]:oe.Closed})},c!=null&&$!=null&&M.createElement(Fe,{disabled:g,data:{[c]:$},form:d,onReset:ae}),re({ourProps:Z,theirProps:L,slot:A,defaultTag:Pt,name:"Listbox"}))))))}let wt="button";function Mt(e,i){let t=v.useId(),o=ht(),n=Y("Listbox.Button"),s=fe("Listbox.Button"),{id:d=o||`headlessui-listbox-button-${t}`,disabled:c=n.disabled||!1,autoFocus:b=!1,...l}=e,m=j(i,Be(),s.actions.setButtonElement),g=ze(),[u,a,x]=E(s,f=>[f.listboxState,f.buttonElement,f.optionsElement]),L=u===S.Open;We(L,{trigger:a,action:v.useCallback(f=>{if(a!=null&&a.contains(f.target))return X.Ignore;let A=f.target.closest('[role="option"]:not([data-disabled])');return at(A)?X.Select(A):x!=null&&x.contains(f.target)?X.Ignore:X.Close},[a,x]),close:s.actions.closeListbox,select:s.actions.selectActiveOption});let R=F(f=>{switch(f.key){case O.Enter:Ce(f.currentTarget);break;case O.Space:case O.ArrowDown:f.preventDefault(),s.actions.openListbox({focus:n.value?h.Nothing:h.First});break;case O.ArrowUp:f.preventDefault(),s.actions.openListbox({focus:n.value?h.Nothing:h.Last});break}}),_=F(f=>{switch(f.key){case O.Space:f.preventDefault();break}}),k=Ye(f=>{var A;s.state.listboxState===S.Open?(ce.flushSync(()=>s.actions.closeListbox()),(A=s.state.buttonElement)==null||A.focus({preventScroll:!0})):(f.preventDefault(),s.actions.openListbox({focus:h.Nothing}))}),$=F(f=>f.preventDefault()),P=xt([d]),I=ft(),{isFocusVisible:N,focusProps:z}=Le({autoFocus:b}),{isHovered:T,hoverProps:Q}=we({isDisabled:c}),{pressed:p,pressProps:w}=Me({disabled:c}),C=K({open:u===S.Open,active:p||u===S.Open,disabled:c,invalid:n.invalid,value:n.value,hover:T,focus:N,autofocus:b}),U=E(s,f=>f.listboxState===S.Open),D=ge(g(),{ref:m,id:d,type:ke(e,a),"aria-haspopup":"listbox","aria-controls":x?.id,"aria-expanded":U,"aria-labelledby":P,"aria-describedby":I,disabled:c||void 0,autoFocus:b,onKeyDown:R,onKeyUp:_,onKeyPress:$},k,z,Q,w);return W()({ourProps:D,theirProps:l,slot:C,defaultTag:wt,name:"Listbox.Button"})}let ye=v.createContext(!1),kt="div",Tt=ve.RenderStrategy|ve.Static;function Ct(e,i){let t=v.useId(),{id:o=`headlessui-listbox-options-${t}`,anchor:n,portal:s=!1,modal:d=!0,transition:c=!1,...b}=e,l=Qe(n),[m,g]=v.useState(null);l&&(s=!0);let u=Y("Listbox.Options"),a=fe("Listbox.Options"),[x,L,R,_]=E(a,r=>[r.listboxState,r.buttonElement,r.optionsElement,r.__demoMode]),k=me(L),$=me(R),P=ut(),[I,N]=ct(c,m,P!==null?(P&oe.Open)===oe.Open:x===S.Open);ot(I,L,a.actions.closeListbox);let z=_?!1:d&&x===S.Open;nt(z,$);let T=_?!1:d&&x===S.Open;Je(T,{allowed:v.useCallback(()=>[L,R],[L,R])});let Q=E(a,a.selectors.didButtonMove)?!1:I,p=E(a,a.selectors.hasFrozenValue)&&!e.static,w=mt(p,u.value),C=v.useCallback(r=>u.compare(w,r),[u.compare,w]),U=E(a,r=>{var V;if(l==null||!((V=l?.to)!=null&&V.includes("selection")))return null;let le=r.options.findIndex(Pe=>C(Pe.dataRef.current.value));return le===-1&&(le=0),le}),D=(()=>{if(l==null)return;if(U===null)return{...l,inner:void 0};let r=Array.from(u.listRef.current.values());return{...l,inner:{listRef:{current:r},index:U}}})(),[f,A]=Ue(D),ie=He(),se=j(i,l?f:null,a.actions.setOptionsElement,g),Z=_e();v.useEffect(()=>{let r=R;r&&x===S.Open&&(rt(r)||r==null||r.focus({preventScroll:!0}))},[x,R]);let ae=F(r=>{var V;switch(Z.dispose(),r.key){case O.Space:if(a.state.searchQuery!=="")return r.preventDefault(),r.stopPropagation(),a.actions.search(r.key);case O.Enter:r.preventDefault(),r.stopPropagation(),a.actions.selectActiveOption();break;case H(u.orientation,{vertical:O.ArrowDown,horizontal:O.ArrowRight}):return r.preventDefault(),r.stopPropagation(),a.actions.goToOption({focus:h.Next});case H(u.orientation,{vertical:O.ArrowUp,horizontal:O.ArrowLeft}):return r.preventDefault(),r.stopPropagation(),a.actions.goToOption({focus:h.Previous});case O.Home:case O.PageUp:return r.preventDefault(),r.stopPropagation(),a.actions.goToOption({focus:h.First});case O.End:case O.PageDown:return r.preventDefault(),r.stopPropagation(),a.actions.goToOption({focus:h.Last});case O.Escape:r.preventDefault(),r.stopPropagation(),ce.flushSync(()=>a.actions.closeListbox()),(V=a.state.buttonElement)==null||V.focus({preventScroll:!0});return;case O.Tab:r.preventDefault(),r.stopPropagation(),ce.flushSync(()=>a.actions.closeListbox()),St(a.state.buttonElement,r.shiftKey?be.Previous:be.Next);break;default:r.key.length===1&&(a.actions.search(r.key),Z.setTimeout(()=>a.actions.clearSearch(),350));break}}),re=E(a,r=>{var V;return(V=r.buttonElement)==null?void 0:V.id}),y=K({open:x===S.Open}),G=ge(l?ie():{},{id:o,ref:se,"aria-activedescendant":E(a,a.selectors.activeDescendantId),"aria-multiselectable":u.mode===B.Multi?!0:void 0,"aria-labelledby":re,"aria-orientation":u.orientation,onKeyDown:ae,role:"listbox",tabIndex:x===S.Open?0:void 0,style:{...b.style,...A,"--button-width":Ke(I,L,!0).width},...dt(N)}),Ee=W(),Re=v.useMemo(()=>u.mode===B.Multi?u:{...u,isSelected:C},[u,C]);return M.createElement(it,{enabled:s?e.static||I:!1,ownerDocument:k},M.createElement(ne.Provider,{value:Re},Ee({ourProps:G,theirProps:b,slot:y,defaultTag:kt,features:Tt,visible:Q,name:"Listbox.Options"})))}let Dt="div";function At(e,i){let t=v.useId(),{id:o=`headlessui-listbox-option-${t}`,disabled:n=!1,value:s,...d}=e,c=v.useContext(ye)===!0,b=Y("Listbox.Option"),l=fe("Listbox.Option"),m=E(l,p=>l.selectors.isActive(p,o)),g=b.isSelected(s),u=v.useRef(null),a=lt(u),x=Ne({disabled:n,value:s,domRef:u,get textValue(){return a()}}),L=j(i,u,p=>{p?b.listRef.current.set(o,p):b.listRef.current.delete(o)}),R=E(l,p=>l.selectors.shouldScrollIntoView(p,o));de(()=>{if(R)return Ve().requestAnimationFrame(()=>{var p,w;(w=(p=u.current)==null?void 0:p.scrollIntoView)==null||w.call(p,{block:"nearest"})})},[R,u]),de(()=>{if(!c)return l.actions.registerOption(o,x),()=>l.actions.unregisterOption(o)},[x,o,c]);let _=F(p=>{if(n)return p.preventDefault();l.actions.selectOption(s)}),k=F(()=>{if(n)return l.actions.goToOption({focus:h.Nothing});l.actions.goToOption({focus:h.Specific,id:o})}),$=Ze(),P=F(p=>$.update(p)),I=F(p=>{$.wasMoved(p)&&(n||m&&l.state.activationTrigger===te.Pointer||l.actions.goToOption({focus:h.Specific,id:o},te.Pointer))}),N=F(p=>{$.wasMoved(p)&&(n||m&&l.state.activationTrigger===te.Pointer&&l.actions.goToOption({focus:h.Nothing}))}),z=K({active:m,focus:m,selected:g,disabled:n,selectedOption:g&&c}),T=c?{}:{id:o,ref:L,role:"option",tabIndex:n===!0?void 0:-1,"aria-disabled":n===!0?!0:void 0,"aria-selected":g,disabled:void 0,onClick:_,onFocus:k,onPointerEnter:P,onMouseEnter:P,onPointerMove:I,onMouseMove:I,onPointerLeave:N,onMouseLeave:N},Q=W();return!g&&c?null:Q({ourProps:T,theirProps:d,slot:z,defaultTag:Dt,name:"Listbox.Option"})}let Ft=v.Fragment;function _t(e,i){let{options:t,placeholder:o,...n}=e,s={ref:j(i)},d=Y("ListboxSelectedOption"),c=K({}),b=d.value===void 0||d.value===null||d.mode===B.Multi&&Array.isArray(d.value)&&d.value.length===0,l=W();return M.createElement(ye.Provider,{value:!0},l({ourProps:s,theirProps:{...n,children:M.createElement(M.Fragment,null,o&&b?o:t)},slot:c,defaultTag:Ft,name:"ListboxSelectedOption"}))}let Nt=q(Lt),Vt=q(Mt),Bt=bt,zt=q(Ct),Qt=q(At),Ut=q(_t),lo=Object.assign(Nt,{Button:Vt,Label:Bt,Options:zt,Option:Qt,SelectedOption:Ut});export{zt as B,Qt as I,lo as M,Vt as a};
