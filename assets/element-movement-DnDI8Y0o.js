import{r as i}from"./index-_abZp7Jz.js";import{s as g}from"./bugs-DrswtJu8.js";import{o as v,d as w}from"./use-sync-refs-c_sb9ZsK.js";import{e as x,i as $}from"./keyboard-Bz6YqB5p.js";import{i as m}from"./portal-DeqkkDyL.js";var b=(e=>(e[e.Left=0]="Left",e[e.Right=2]="Right",e))(b||{});function N(e){let n=i.useRef(null),t=v(o=>{n.current=o.pointerType,!g(o.currentTarget)&&o.pointerType==="mouse"&&o.button===b.Left&&(o.preventDefault(),e(o))}),u=v(o=>{n.current!=="mouse"&&(g(o.currentTarget)||e(o))});return{onPointerDown:t,onClick:u}}var R=(e=>(e[e.Ignore=0]="Ignore",e[e.Select=1]="Select",e[e.Close=2]="Close",e))(R||{});const P={Ignore:{kind:0},Select:e=>({kind:1,target:e}),Close:{kind:2}},I=200,h=5;function z(e,{trigger:n,action:t,close:u,select:o}){let r=i.useRef(null),l=i.useRef(null),c=i.useRef(null);m(e&&n!==null,"pointerdown",s=>{x(s?.target)&&n!=null&&n.contains(s.target)&&(l.current=s.x,c.current=s.y,r.current=s.timeStamp)}),m(e&&n!==null,"pointerup",s=>{var a,d;let f=r.current;if(f===null||(r.current=null,!$(s.target))||Math.abs(s.x-((a=l.current)!=null?a:s.x))<h&&Math.abs(s.y-((d=c.current)!=null?d:s.y))<h)return;let p=t(s);switch(p.kind){case 0:return;case 1:{s.timeStamp-f>I&&(o(p.target),u());break}case 2:{u();break}}},{capture:!0})}function k(e){return[e.screenX,e.screenY]}function F(){let e=i.useRef([-1,-1]);return{wasMoved(n){let t=k(n);return e.current[0]===t[0]&&e.current[1]===t[1]?!1:(e.current=t,!0)},update(n){e.current=k(n)}}}function L(e){throw new Error("Unexpected object: "+e)}var S=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(S||{});function j(e,n){let t=n.resolveItems();if(t.length<=0)return null;let u=n.resolveActiveIndex(),o=u??-1;switch(e.focus){case 0:{for(let r=0;r<t.length;++r)if(!n.resolveDisabled(t[r],r,t))return r;return u}case 1:{o===-1&&(o=t.length);for(let r=o-1;r>=0;--r)if(!n.resolveDisabled(t[r],r,t))return r;return u}case 2:{for(let r=o+1;r<t.length;++r)if(!n.resolveDisabled(t[r],r,t))return r;return u}case 3:{for(let r=t.length-1;r>=0;--r)if(!n.resolveDisabled(t[r],r,t))return r;return u}case 4:{for(let r=0;r<t.length;++r)if(n.resolveId(t[r],r,t)===e.id)return r;return u}case 5:return null;default:L(e)}}const A={Idle:{kind:"Idle"},Tracked:e=>({kind:"Tracked",position:e}),Moved:{kind:"Moved"}};function T(e){let n=e.getBoundingClientRect();return`${n.x},${n.y}`}function B(e,n,t){let u=w();if(n.kind==="Tracked"){let o=function(){r!==T(e)&&(u.dispose(),t())},{position:r}=n,l=new ResizeObserver(o);l.observe(e),u.add(()=>l.disconnect()),u.addEventListener(window,"scroll",o,{passive:!0}),u.addEventListener(window,"resize",o)}return()=>u.dispose()}export{z as L,P as S,S as a,T as b,A as c,j as f,b as g,B as p,N as s,F as u};
