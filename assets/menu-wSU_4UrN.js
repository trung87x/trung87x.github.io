import{$ as he,a as Se}from"./useFocusRing-DcMgcFf7.js";import{r as p,G as C}from"./index-BUE_4nSx.js";import{r as Y}from"./index-5-nG4q7h.js";import{w as ye}from"./use-active-press-CdjcnPjf.js";import{u as ae,Y as D,o as P,V as le,K as O,p as $e,n as K,a as Me,A as ee}from"./render-CNyBWpu3.js";import{b as Pe,F as xe,y as Ee,R as Te,T as ke,w as we,A as Ce}from"./floating-DDf1F5o_.js";import{p as De,c as Q,a as v,f as H,b as Oe,L as Re,S as U,s as Fe,u as _e}from"./element-movement-DVBsFgAL.js";import{y as Ae}from"./use-inert-others-BaroeGy-.js";import{T as Ne,a as te,x as ie,b as Ge,c as Le,S as k,u as ne,p as Be,f as He,t as Ue,k as Ke}from"./portal-DcpW2Nz_.js";import{e as Qe}from"./use-resolve-button-type-BuRlBvvn.js";import{n as q}from"./use-slot-BZcd_w4P.js";import{y as z}from"./use-sync-refs-Dh0umLOC.js";import{s as Ve}from"./use-text-value-Bui0uthF.js";import{u as je,N as qe,i as V,x as ze,c as Ye}from"./open-closed-BGpwrHHP.js";import{F as Ze}from"./use-tree-walker-BMsWof6B.js";import{n as Je}from"./dom-BlW_0b_t.js";import{G as We,R as Xe,T as re,K as ue,H as et,I as tt}from"./focus-management-C0S51YJM.js";import{d as nt}from"./owner-C7ikqkQc.js";import{H as rt}from"./description-11b0SVwG.js";import{o as h}from"./keyboard-C1Wiwm26.js";import{V as de,C as st}from"./label-CN3TFCLp.js";var ot=Object.defineProperty,at=(e,r,t)=>r in e?ot(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,se=(e,r,t)=>(at(e,typeof r!="symbol"?r+"":r,t),t),S=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(S||{}),j=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(j||{}),u=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItems=5]="RegisterItems",e[e.UnregisterItems=6]="UnregisterItems",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e[e.SortItems=9]="SortItems",e[e.MarkButtonAsMoved=10]="MarkButtonAsMoved",e))(u||{});function oe(e,r=t=>t){let t=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=We(r(e.items.slice()),a=>a.dataRef.current.domRef.current),s=t?n.indexOf(t):null;return s===-1&&(s=null),{items:n,activeItemIndex:s}}let lt={1(e){if(e.menuState===1)return e;let r=e.buttonElement?Q.Tracked(Oe(e.buttonElement)):e.buttonPositionState;return{...e,activeItemIndex:null,pendingFocus:{focus:v.Nothing},menuState:1,buttonPositionState:r}},0(e,r){return e.menuState===0?e:{...e,__demoMode:!1,pendingFocus:r.focus,menuState:0,buttonPositionState:Q.Idle}},2:(e,r)=>{var t,n,s,a,i;if(e.menuState===1)return e;let f={...e,searchQuery:"",activationTrigger:(t=r.trigger)!=null?t:1,__demoMode:!1};if(r.focus===v.Nothing)return{...f,activeItemIndex:null};if(r.focus===v.Specific)return{...f,activeItemIndex:e.items.findIndex(o=>o.id===r.id)};if(r.focus===v.Previous){let o=e.activeItemIndex;if(o!==null){let E=e.items[o].dataRef.current.domRef,b=H(r,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.current.disabled});if(b!==null){let c=e.items[b].dataRef.current.domRef;if(((n=E.current)==null?void 0:n.previousElementSibling)===c.current||((s=c.current)==null?void 0:s.previousElementSibling)===null)return{...f,activeItemIndex:b}}}}else if(r.focus===v.Next){let o=e.activeItemIndex;if(o!==null){let E=e.items[o].dataRef.current.domRef,b=H(r,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.current.disabled});if(b!==null){let c=e.items[b].dataRef.current.domRef;if(((a=E.current)==null?void 0:a.nextElementSibling)===c.current||((i=c.current)==null?void 0:i.nextElementSibling)===null)return{...f,activeItemIndex:b}}}}let I=oe(e),x=H(r,{resolveItems:()=>I.items,resolveActiveIndex:()=>I.activeItemIndex,resolveId:o=>o.id,resolveDisabled:o=>o.dataRef.current.disabled});return{...f,...I,activeItemIndex:x}},3:(e,r)=>{let t=e.searchQuery!==""?0:1,n=e.searchQuery+r.value.toLowerCase(),s=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+t).concat(e.items.slice(0,e.activeItemIndex+t)):e.items).find(i=>{var f;return((f=i.dataRef.current.textValue)==null?void 0:f.startsWith(n))&&!i.dataRef.current.disabled}),a=s?e.items.indexOf(s):-1;return a===-1||a===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:a,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,r)=>{let t=e.items.concat(r.items.map(s=>s)),n=e.activeItemIndex;return e.pendingFocus.focus!==v.Nothing&&(n=H(e.pendingFocus,{resolveItems:()=>t,resolveActiveIndex:()=>e.activeItemIndex,resolveId:s=>s.id,resolveDisabled:s=>s.dataRef.current.disabled})),{...e,items:t,activeItemIndex:n,pendingFocus:{focus:v.Nothing},pendingShouldSort:!0}},6:(e,r)=>{let t=e.items,n=[],s=new Set(r.items);for(let[a,i]of t.entries())if(s.has(i.id)&&(n.push(a),s.delete(i.id),s.size===0))break;if(n.length>0){t=t.slice();for(let a of n.reverse())t.splice(a,1)}return{...e,items:t,activationTrigger:1}},7:(e,r)=>e.buttonElement===r.element?e:{...e,buttonElement:r.element},8:(e,r)=>e.itemsElement===r.element?e:{...e,itemsElement:r.element},9:e=>e.pendingShouldSort?{...e,...oe(e),pendingShouldSort:!1}:e,10(e){return e.buttonPositionState.kind!=="Tracked"?e:{...e,buttonPositionState:Q.Moved}}};class Z extends Ne{constructor(r){super(r),se(this,"actions",{registerItem:te(()=>{let t=[],n=new Set;return[(s,a)=>{n.has(a)||(n.add(a),t.push({id:s,dataRef:a}))},()=>(n.clear(),this.send({type:5,items:t.splice(0)}))]}),unregisterItem:te(()=>{let t=[];return[n=>t.push(n),()=>this.send({type:6,items:t.splice(0)})]})}),se(this,"selectors",{activeDescendantId(t){var n;let s=t.activeItemIndex,a=t.items;return s===null||(n=a[s])==null?void 0:n.id},isActive(t,n){var s;let a=t.activeItemIndex,i=t.items;return a!==null?((s=i[a])==null?void 0:s.id)===n:!1},shouldScrollIntoView(t,n){return t.__demoMode||t.menuState!==0||t.activationTrigger===0?!1:this.isActive(t,n)},didButtonMove(t){return t.buttonPositionState.kind==="Moved"}}),this.on(5,()=>{this.disposables.requestAnimationFrame(()=>{this.send({type:9})})});{let t=this.state.id,n=ie.get(null);this.disposables.add(n.on(Ge.Push,s=>{!n.selectors.isTop(s,t)&&this.state.menuState===0&&this.send({type:1})})),this.on(0,()=>n.actions.push(t)),this.on(1,()=>n.actions.pop(t))}this.disposables.group(t=>{this.on(1,n=>{n.buttonElement&&(t.dispose(),t.add(De(n.buttonElement,n.buttonPositionState,()=>{this.send({type:10})})))})})}static new({id:r,__demoMode:t=!1}){return new Z({id:r,__demoMode:t,menuState:t?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1,pendingShouldSort:!1,pendingFocus:{focus:v.Nothing},buttonPositionState:Q.Idle})}reduce(r,t){return ae(t.type,lt,r,t)}}const ce=p.createContext(null);function J(e){let r=p.useContext(ce);if(r===null){let t=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,me),t}return r}function me({id:e,__demoMode:r=!1}){let t=p.useMemo(()=>Z.new({id:e,__demoMode:r}),[]);return Le(()=>t.dispose()),t}let it=p.Fragment;function ut(e,r){let t=p.useId(),{__demoMode:n=!1,...s}=e,a=me({id:t,__demoMode:n}),[i,f,I]=k(a,y=>[y.menuState,y.itemsElement,y.buttonElement]),x=z(r),o=ie.get(null),E=k(o,p.useCallback(y=>o.selectors.isTop(y,t),[o,t]));Ke(E,[I,f],(y,$)=>{var M;a.send({type:u.CloseMenu}),et($,tt.Loose)||(y.preventDefault(),(M=a.state.buttonElement)==null||M.focus())});let b=P(()=>{a.send({type:u.CloseMenu})}),c=q({open:i===S.Open,close:b}),g={ref:x},T=O();return C.createElement(Ce,null,C.createElement(ce.Provider,{value:a},C.createElement(Ye,{value:ae(i,{[S.Open]:V.Open,[S.Closed]:V.Closed})},T({ourProps:g,theirProps:s,slot:c,defaultTag:it,name:"Menu"}))))}let dt="button";function ct(e,r){let t=J("Menu.Button"),n=p.useId(),{id:s=`headlessui-menu-button-${n}`,disabled:a=!1,autoFocus:i=!1,...f}=e,I=p.useRef(null),x=Pe(),o=z(r,I,xe(),P(d=>t.send({type:u.SetButtonElement,element:d}))),E=P(d=>{switch(d.key){case h.Space:case h.Enter:case h.ArrowDown:d.preventDefault(),d.stopPropagation(),t.send({type:u.OpenMenu,focus:{focus:v.First}});break;case h.ArrowUp:d.preventDefault(),d.stopPropagation(),t.send({type:u.OpenMenu,focus:{focus:v.Last}});break}}),b=P(d=>{d.key===h.Space&&d.preventDefault()}),[c,g,T]=k(t,d=>[d.menuState,d.buttonElement,d.itemsElement]),y=c===S.Open;Re(y,{trigger:g,action:p.useCallback(d=>{if(g!=null&&g.contains(d.target))return U.Ignore;let m=d.target.closest('[role="menuitem"]:not([data-disabled])');return Je(m)?U.Select(m):T!=null&&T.contains(d.target)?U.Ignore:U.Close},[g,T]),close:p.useCallback(()=>t.send({type:u.CloseMenu}),[]),select:p.useCallback(d=>d.click(),[])});let $=Fe(d=>{var m;a||(c===S.Open?(Y.flushSync(()=>t.send({type:u.CloseMenu})),(m=I.current)==null||m.focus({preventScroll:!0})):(d.preventDefault(),t.send({type:u.OpenMenu,focus:{focus:v.Nothing},trigger:j.Pointer})))}),{isFocusVisible:M,focusProps:R}=he({autoFocus:i}),{isHovered:A,hoverProps:F}=Se({isDisabled:a}),{pressed:w,pressProps:N}=ye({disabled:a}),_=q({open:c===S.Open,active:w||c===S.Open,disabled:a,hover:A,focus:M,autofocus:i}),G=le(x(),{ref:o,id:s,type:Qe(e,I.current),"aria-haspopup":"menu","aria-controls":T?.id,"aria-expanded":c===S.Open,disabled:a||void 0,autoFocus:i,onKeyDown:E,onKeyUp:b},$,R,F,N);return O()({ourProps:G,theirProps:f,slot:_,defaultTag:dt,name:"Menu.Button"})}let mt="div",pt=ee.RenderStrategy|ee.Static;function ft(e,r){let t=p.useId(),{id:n=`headlessui-menu-items-${t}`,anchor:s,portal:a=!1,modal:i=!0,transition:f=!1,...I}=e,x=Ee(s),o=J("Menu.Items"),[E,b]=Te(x),c=ke(),[g,T]=p.useState(null),y=z(r,x?E:null,P(l=>o.send({type:u.SetItemsElement,element:l})),T),[$,M]=k(o,l=>[l.menuState,l.buttonElement]),R=ne(M),A=ne(g);x&&(a=!0);let F=je(),[w,N]=qe(f,g,F!==null?(F&V.Open)===V.Open:$===S.Open);Be(w,M,()=>{o.send({type:u.CloseMenu})});let _=k(o,l=>l.__demoMode),G=_?!1:i&&$===S.Open;He(G,A);let d=_?!1:i&&$===S.Open;Ae(d,{allowed:p.useCallback(()=>[M,g],[M,g])});let m=k(o,o.selectors.didButtonMove)?!1:w;p.useEffect(()=>{let l=g;l&&$===S.Open&&(nt(l)||l.focus({preventScroll:!0}))},[$,g]),Ze($===S.Open,{container:g,accept(l){return l.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:l.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(l){l.setAttribute("role","none")}});let L=$e(),pe=P(l=>{var B,W,X;switch(L.dispose(),l.key){case h.Space:if(o.state.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),o.send({type:u.Search,value:l.key});case h.Enter:if(l.preventDefault(),l.stopPropagation(),o.state.activeItemIndex!==null){let{dataRef:ge}=o.state.items[o.state.activeItemIndex];(W=(B=ge.current)==null?void 0:B.domRef.current)==null||W.click()}o.send({type:u.CloseMenu}),ue(o.state.buttonElement);break;case h.ArrowDown:return l.preventDefault(),l.stopPropagation(),o.send({type:u.GoToItem,focus:v.Next});case h.ArrowUp:return l.preventDefault(),l.stopPropagation(),o.send({type:u.GoToItem,focus:v.Previous});case h.Home:case h.PageUp:return l.preventDefault(),l.stopPropagation(),o.send({type:u.GoToItem,focus:v.First});case h.End:case h.PageDown:return l.preventDefault(),l.stopPropagation(),o.send({type:u.GoToItem,focus:v.Last});case h.Escape:l.preventDefault(),l.stopPropagation(),Y.flushSync(()=>o.send({type:u.CloseMenu})),(X=o.state.buttonElement)==null||X.focus({preventScroll:!0});break;case h.Tab:l.preventDefault(),l.stopPropagation(),Y.flushSync(()=>o.send({type:u.CloseMenu})),Xe(o.state.buttonElement,l.shiftKey?re.Previous:re.Next);break;default:l.key.length===1&&(o.send({type:u.Search,value:l.key}),L.setTimeout(()=>o.send({type:u.ClearSearch}),350));break}}),fe=P(l=>{l.key===h.Space&&l.preventDefault()}),ve=q({open:$===S.Open}),Ie=le(x?c():{},{"aria-activedescendant":k(o,o.selectors.activeDescendantId),"aria-labelledby":k(o,l=>{var B;return(B=l.buttonElement)==null?void 0:B.id}),id:n,onKeyDown:pe,onKeyUp:fe,role:"menu",tabIndex:$===S.Open?0:void 0,ref:y,style:{...I.style,...b,"--button-width":we(w,M,!0).width},...ze(N)}),be=O();return C.createElement(Ue,{enabled:a?e.static||w:!1,ownerDocument:R},be({ourProps:Ie,theirProps:I,slot:ve,defaultTag:mt,features:pt,visible:m,name:"Menu.Items"}))}let vt=p.Fragment;function It(e,r){let t=p.useId(),{id:n=`headlessui-menu-item-${t}`,disabled:s=!1,...a}=e,i=J("Menu.Item"),f=k(i,m=>i.selectors.isActive(m,n)),I=p.useRef(null),x=z(r,I),o=k(i,m=>i.selectors.shouldScrollIntoView(m,n));K(()=>{if(o)return Me().requestAnimationFrame(()=>{var m,L;(L=(m=I.current)==null?void 0:m.scrollIntoView)==null||L.call(m,{block:"nearest"})})},[o,I]);let E=Ve(I),b=p.useRef({disabled:s,domRef:I,get textValue(){return E()}});K(()=>{b.current.disabled=s},[b,s]),K(()=>(i.actions.registerItem(n,b),()=>i.actions.unregisterItem(n)),[b,n]);let c=P(()=>{i.send({type:u.CloseMenu})}),g=P(m=>{if(s)return m.preventDefault();i.send({type:u.CloseMenu}),ue(i.state.buttonElement)}),T=P(()=>{if(s)return i.send({type:u.GoToItem,focus:v.Nothing});i.send({type:u.GoToItem,focus:v.Specific,id:n})}),y=_e(),$=P(m=>y.update(m)),M=P(m=>{y.wasMoved(m)&&(s||f||i.send({type:u.GoToItem,focus:v.Specific,id:n,trigger:j.Pointer}))}),R=P(m=>{y.wasMoved(m)&&(s||f&&i.state.activationTrigger===j.Pointer&&i.send({type:u.GoToItem,focus:v.Nothing}))}),[A,F]=de(),[w,N]=rt(),_=q({active:f,focus:f,disabled:s,close:c}),G={id:n,ref:x,role:"menuitem",tabIndex:s===!0?void 0:-1,"aria-disabled":s===!0?!0:void 0,"aria-labelledby":A,"aria-describedby":w,disabled:void 0,onClick:g,onFocus:T,onPointerEnter:$,onMouseEnter:$,onPointerMove:M,onMouseMove:M,onPointerLeave:R,onMouseLeave:R},d=O();return C.createElement(F,null,C.createElement(N,null,d({ourProps:G,theirProps:a,slot:_,defaultTag:vt,name:"Menu.Item"})))}let bt="div";function gt(e,r){let[t,n]=de(),s=e,a={ref:r,"aria-labelledby":t,role:"group"},i=O();return C.createElement(n,null,i({ourProps:a,theirProps:s,slot:{},defaultTag:bt,name:"Menu.Section"}))}let ht="header";function St(e,r){let t=p.useId(),{id:n=`headlessui-menu-heading-${t}`,...s}=e,a=st();K(()=>a.register(n),[n,a.register]);let i={id:n,ref:r,role:"presentation",...a.props};return O()({ourProps:i,theirProps:s,slot:{},defaultTag:ht,name:"Menu.Heading"})}let yt="div";function $t(e,r){let t=e,n={ref:r,role:"separator"};return O()({ourProps:n,theirProps:t,slot:{},defaultTag:yt,name:"Menu.Separator"})}let Mt=D(ut),Pt=D(ct),xt=D(ft),Et=D(It),Tt=D(gt),kt=D(St),wt=D($t),Jt=Object.assign(Mt,{Button:Pt,Items:xt,Item:Et,Section:Tt,Heading:kt,Separator:wt});export{kt as E,wt as M,Tt as P,Pt as f,Et as g,Jt as l,xt as y};
